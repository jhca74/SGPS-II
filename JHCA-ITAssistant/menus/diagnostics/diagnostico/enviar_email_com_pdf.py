import osimport base64import smtplibimport mimetypesfrom email.message import EmailMessagefrom google.auth.transport.requests import Requestfrom google.oauth2.credentials import Credentials# ConfiguraÃ§Ãµes da contaEMAIL_REMETENTE = "info@jhca.pt"CLIENT_ID = "572748096099-0j7n12or7emareblt0vtiu0frt97ttb5.apps.googleusercontent.com"CLIENT_SECRET = "COLOCA_AQUI_O_CLIENT_SECRET"REFRESH_TOKEN = "COLOCA_AQUI_O_REFRESH_TOKEN"TOKEN_URI = "https://oauth2.googleapis.com/token"def enviar_email_com_pdf(destinatario: str, assunto: str, corpo: str, caminho_pdf: str):    creds = Credentials(        None,        refresh_token=REFRESH_TOKEN,        client_id=CLIENT_ID,        client_secret=CLIENT_SECRET,        token_uri=TOKEN_URI    )    creds.refresh(Request())    access_token = creds.token    mensagem = EmailMessage()    mensagem["From"] = EMAIL_REMETENTE    mensagem["To"] = destinatario    mensagem["Subject"] = assunto    mensagem.set_content(corpo)    tipo, _ = mimetypes.guess_type(caminho_pdf)    tipo = tipo or "application/octet-stream"    with open(caminho_pdf, "rb") as f:        dados = f.read()    mensagem.add_attachment(dados, maintype="application", subtype="pdf", filename=os.path.basename(caminho_pdf))    auth_string = f"user={EMAIL_REMETENTE}\1auth=Bearer {access_token}\1\1"    auth_bytes = base64.b64encode(auth_string.encode("utf-8"))    with smtplib.SMTP("smtp.gmail.com", 587) as servidor:        servidor.ehlo()        servidor.starttls()        servidor.ehlo()        servidor.docmd("AUTH", "XOAUTH2 " + auth_bytes.decode("utf-8"))        servidor.send_message(mensagem)