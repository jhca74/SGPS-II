import jsonfrom pathlib import Pathfrom datetime import datetimefrom memoria_emocional import MemoriaEmocionalclass LoopAprendizagem:    def __init__(self, caminho_compendio="memoria/compendio.json"):        self.memoria = MemoriaEmocional()        self.caminho = Path(caminho_compendio)        self._inicializar_compendio()    def _inicializar_compendio(self):        if not self.caminho.exists():            with open(self.caminho, "w", encoding="utf-8") as f:                json.dump([], f, indent=2, ensure_ascii=False)    def registar_interacao(self, pergunta, resposta):        estado_emocional = self.memoria.obter_estado()        nova_entrada = {            "data": datetime.now().isoformat(),            "pergunta": pergunta,            "resposta": resposta,            "emocao": estado_emocional.get("emocao"),            "intensidade": estado_emocional.get("intensidade")        }        with open(self.caminho, "r+", encoding="utf-8") as f:            dados = json.load(f)            dados.append(nova_entrada)            f.seek(0)            json.dump(dados, f, indent=2, ensure_ascii=False)    def consultar_ultimas(self, n=5):        with open(self.caminho, "r", encoding="utf-8") as f:            dados = json.load(f)            return dados[-n:]