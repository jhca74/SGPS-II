!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6f34ef85-6353-4016-bcea-3f70913003d3",e._sentryDebugIdIdentifier="sentry-dbid-6f34ef85-6353-4016-bcea-3f70913003d3")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2512],{16331:function(e,t,a){a.d(t,{t:function(){return n}}),a(56481);var n=(0,a(9230).$)("f0758cc0b4308f0f79cffc3a906bcc72612271fa")},86173:function(e,t,a){a.d(t,{R:function(){return W},t:function(){return Y}});var n=a(584),s=a(16331),r=a(19922),i=a(62339),l=a(22852),o=a(85682),c=a(98964),d=a(95397),u=a(12405),m=a(61500),p=a(29997),x=a(50240),f=a(66070),h=a(99406),g=a(15674);let b={pt:"pt-PT","uk-UA":"uk",zh:"zh-CN","zh-TW":"zh-TW"},v=(e,t)=>{let{GOOGLE_APP_ID:a}=(0,m.O)(),{t:n}=(0,f.$G)("chat"),s=(0,r.gK)(e=>e.conversationId)||"no_conversation_id",i=(0,g.U)(),l=b[i]||i,[o,c]=(0,x.useState)(!0),[d,u]=(0,x.useState)(null);return(0,x.useEffect)(()=>{(async()=>{let e=document.createElement("script");e.src="https://apis.google.com/js/api.js",e.async=!0,e.onload=()=>{window.gapi.load("picker",()=>c(!1))},document.body.append(e)})().catch(h.Am.error)},[]),(0,x.useEffect)(()=>{var r;if(o||!e||!(null===(r=window.google)||void 0===r?void 0:r.picker))return;let i=new window.google.picker.DocsView(window.google.picker.ViewId.DOCS).setMode(window.google.picker.DocsViewMode.LIST).setIncludeFolders(!0).setLabel(n("google-drive-picker.file-tab.all","All")),c=new window.google.picker.DocsView(window.google.picker.ViewId.DOCS).setMode(window.google.picker.DocsViewMode.LIST).setIncludeFolders(!0).setOwnedByMe(!0).setLabel(n("google-drive-picker.file-tab.owned-by-me","Owned by Me"));u(new window.google.picker.PickerBuilder().addView(i).addView(c).hideTitleBar().setOAuthToken(e).setAppId(a).setLocale(l).enableFeature(window.google.picker.Feature.MULTISELECT_ENABLED).setMaxItems(p.gt).setCallback(async e=>{var a;"picked"===e.action&&(null===(a=e.docs)||void 0===a?void 0:a.length)&&await Promise.all(e.docs.map(e=>{var a,n;return t(null!==(a=e.name)&&void 0!==a?a:"Untitled document",null!==(n=e.mimeType)&&void 0!==n?n:"application/vnd.google-apps.document","GOOGLE_DRIVE_FILE_SOURCE",e.id,s)}))}).build())},[o,e,a,l,t,s,n]),{setIsPickerOpen:(0,x.useCallback)(e=>{d&&d.setVisible(e)},[d]),isLoading:o}};var y=a(89576),w=a(49901),j=a(24638),k=a(75124),C=a(32088),N=a(25693),S=a(7263),E=a(10949),I=a(46751),_=a(23859),T=a(73878),Z=a(84737),D=a(25520),A=a(55608),O=a(9354),K=a(69074),z=a(78174),R=a(98526),M=a(22838),L=a(41662),G=a(13642),F=a(2103),P=a(68145);let H=(0,a(75202).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),U=x.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(P.f,{ref:t,className:(0,S.cn)(H(),a),...s})});function $(e){let{onTextContentUpload:t}=e,[a,s]=(0,x.useState)(!1),{t:r}=(0,f.$G)("settings"),[i,c]=(0,x.useState)(!1),{register:d,handleSubmit:u,formState:{errors:m},reset:p}=(0,L.cI)({defaultValues:{fileName:"",textValue:""}}),h=async e=>{c(!0);try{let a=e.fileName.trim().length>0?e.fileName.trim():r("add-text-content-form.filename-placeholder","pasted-text.txt");t(a,e.textValue),p(),s(!1)}catch(e){(0,j.H)("add-text-content-form.handleTextContentUpload",e)}finally{c(!1)}};return(0,R.y)(z.FG,()=>{u(h)().catch(e=>{(0,j.H)("add-text-content-form.handleTextContentUpload",e)})},[u,h]),(0,n.jsxs)(o.Ph,{open:a,onOpenChange:s,children:[(0,n.jsxs)(o.kt,{className:"flex flex-row pr-3 py-2.5 gap-2",children:[(0,n.jsx)(Z.Z,{size:16,className:"opacity-70"}),r("attach-dropdown.text-file","Add text content")]}),(0,n.jsx)(o.cq,{children:(0,n.jsx)(o.TG,{sideOffset:8,className:"space-y-1",onClick:e=>e.stopPropagation(),children:(0,n.jsxs)("form",{onSubmit:u(h),className:"flex flex-col gap-2 min-w-80 p-1",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)(U,{htmlFor:"fileName",className:"text-xs ps-2",children:r("add-text-content-form.filename-label","File name")}),(0,n.jsx)(F.I,{...d("fileName"),placeholder:r("add-text-content-form.filename-placeholder","pasted-text.txt"),className:"border border-toggle-border rounded-xl",role:"menuitem"})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsx)(U,{htmlFor:"textValue",className:"text-xs ps-2",children:r("add-text-content-form.text-label","Text content")}),(0,n.jsx)(G.Z,{className:(0,S.cn)("w-full p-3 text-sm align-bottom bg-transparent focus:outline-none text-primary rounded-xl","border border-toggle-border focus-visible:ring-1 focus-visible:ring-ring"),...d("textValue",{required:r("add-text-content-form.text-required","Text content is required"),maxLength:{value:3e5,message:r("add-text-content-form.text-max-length","Text content must be less than {{maxLength}} characters",{maxLength:3e5})}}),placeholder:r("add-text-content-form.placeholder","Enter text content..."),style:{resize:"none"},minRows:4,maxRows:8,role:"menuitem"})]}),(0,n.jsxs)("div",{className:"flex flex-row justify-between gap-2 px-0 min-h-10",children:[(0,n.jsx)("div",{className:(0,S.cn)("flex flex-row items-center gap-1 text-xs ps-2",m.textValue?"text-red-500":"opacity-0"),children:m.textValue&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:m.textValue.message}),(0,n.jsx)("span",{className:"flex flex-row items-center gap-1",children:(0,n.jsx)(M.Z,{className:"size-4 shrink-0"})})]})}),(0,n.jsx)(o.Xi,{asChild:!0,children:(0,n.jsx)(l.zx,{type:"submit",variant:"outline",className:"bg-transparent text-primary shadow-none rounded-xl hover:bg-button-ghost-hover m-[1px]",disabled:i,children:r("add-text-content-form.submit","Upload")})})]})]})})})]})}U.displayName=P.f.displayName;var B=a(8521),q=a(98678);function W(e){var t,a;let{label:s,disabled:i=!1,queryBarExpanded:l=!0,totalFileCount:o,handleClickUpload:c}=e,m=(0,r.gK)(O.Z("conversationId"))||"no_conversation_id",{t:g}=(0,f.$G)("base"),{client:b}=(0,C.useStatsigClient)(),v=(0,d.g)(),y=(0,I.O)(O.Z("listByConversationId")),w=(0,I.O)(O.Z("attachListByConversationId")),k=(0,I.O)(O.Z("lisertAttachByConversationId")),N=y[m]||[],S=w[m]||[],_=(0,E.a)(O.Z("listByReq")),T=(0,I.O)(O.Z("delistAttachByConversationId")),Z=(0,E.a)(O.Z("fetchListAssets")),D=(0,E.a)(O.Z("fetchDeleteAssetMetadata")),A=(0,I.O)(e=>e.fetchAttachThirdPartyFile),{attachFiles:K}=(0,u.G)();(0,x.useEffect)(()=>{Z({pageSize:9,orderBy:"ORDER_BY_LAST_USE_TIME"}).catch(e=>(0,j.H)("attach-dropdown.fetchListAssets",e))},[]);let z=null!==(a=null===(t=Object.values(_)[0])||void 0===t?void 0:t.assets)&&void 0!==a?a:[],R=(0,x.useCallback)(e=>{!e||S.some(t=>t.assetId===e.assetId)||(N.length+S.length+1<=p.gt?(k(e,m),b.logEvent("attach-dropdown-asset-clicked",e.assetId,{assetId:e.assetId})):h.Am.error(g("query-files-limit-error","Max number of files allowed is {{maxNumberOfFiles}}",{maxNumberOfFiles:p.gt})))},[k,m,N,S,b,g]),M=(0,x.useCallback)(async e=>{e&&(await D({assetId:e}).catch(e=>(0,j.H)("attach-dropdown.handleDeleteAsset",e)),T(m,e))},[m,T,D]);return(0,n.jsx)(Y,{label:s,disabled:i,queryBarExpanded:l,totalFileCount:o,inlineLabel:!1,handleClickUpload:c,onAttachAsset:R,showRecentAssetsForUpload:v.SHOW_RECENT_ASSETS_FOR_UPLOAD,assets:z,deleteAsset:M,handleUploadThirdParty:A,attachFiles:K})}function Y(e){var t,a;let{label:m,disabled:p=!1,queryBarExpanded:h=!0,totalFileCount:g,inlineLabel:b,handleClickUpload:E,onAttachAsset:I,assets:O,showRecentAssetsForUpload:z,deleteAsset:R,handleUploadThirdParty:M,className:L,attachFiles:G}=e,{t:F}=(0,f.$G)("base"),{client:P}=(0,C.useStatsigClient)(),H=(0,y.w)(),{data:U}=(0,w.h)(),W=null==U?void 0:null===(t=U.find(e=>"GOOGLE_DRIVE"===e.provider))||void 0===t?void 0:t.accessToken,Y=null==U?void 0:null===(a=U.find(e=>"MICROSOFT_ONEDRIVE"===e.provider))||void 0===a?void 0:a.accessToken,V=(0,d.g)(),X=(0,N.Db)({mutationFn:async()=>{let e=window.location.host,t="".concat(e.startsWith("localhost")?"http://":"https://").concat(e).concat(c.zS),a=await (0,s.t)(t,"GOOGLE_DRIVE",window.location.href);window.open(a||c.DA,"_blank")},onError:e=>{(0,j.H)("attach-dropdown.connect-google-drive",e),window.open(c.DA,"_blank")}}),Q=async()=>{P.logEvent("attach-dropdown-connect-google-drive-clicked"),X.mutate()},{setIsPickerOpen:J}=v(W,M),ee=(0,x.useCallback)(()=>{P.logEvent("attach-dropdown-google-drive-picker-opened"),J(!0)},[J,P]),{connectOneDrive:et,openOneDrivePicker:ea}=function(e){let{uploadThirdPartyFile:t,accessToken:a}=e,n=(0,r.gK)(e=>e.conversationId)||"no_conversation_id",[i,l]=(0,x.useState)(null),{client:o}=(0,C.useStatsigClient)(),d=(0,N.Db)({mutationFn:async()=>{let e=window.location.host,t="".concat(e.startsWith("localhost")?"http://":"https://").concat(e).concat(c.zS),a=await (0,s.t)(t,"MICROSOFT_ONEDRIVE",window.location.href);window.open(a||c.DA,"_blank")},onError:e=>{(0,j.H)("attach-dropdown.connect-one-drive",e),window.open(c.DA,"_blank")}}),m=async()=>{o.logEvent("attach-dropdown-connect-one-drive-clicked"),d.mutate()};(0,x.useEffect)(()=>()=>{i&&i.close()},[i]);let p=(0,x.useCallback)(()=>{if(!a)return;if(i&&!i.closed){i.focus();return}let e={sdk:"8.0",entry:{oneDrive:{}},authentication:{},messaging:{origin:window.location.origin,channelId:27},typesAndSources:{mode:"files",pivots:{oneDrive:!0,recent:!0}},selection:{mode:"multiple"}},s=new URLSearchParams({filePicker:JSON.stringify(e)}),r=window.open("","Picker","width=1080,height=680");if(l(r),r){let i;let c=r.document.createElement("form");c.setAttribute("action","https://onedrive.live.com/picker?".concat(s)),c.setAttribute("method","POST");let d=r.document.createElement("input");async function o(e){let s=e.data;switch(s.type){case"notification":s.data.notification;break;case"command":{i.postMessage({type:"acknowledge",id:e.data.id});let o=s.data;switch(o.command){case"authenticate":try{if(!a)throw Error("Unable to obtain a token.");i.postMessage({type:"result",id:e.data.id,data:{result:"token",token:a}})}catch(e){r&&r.close()}break;case"close":r&&r.close(),l(null);break;case"pick":try{await Promise.all(o.items.filter(e=>e.name.match(/\.([^.]+)$/)).map(e=>{let a=e.name.match(/\.([^.]+)$/)[1];return t(e.name,(0,u.i)(a),k.R_.OneDriveFileSource,e.id,n)})),i.postMessage({type:"result",id:e.data.id,data:{result:"success"}})}catch(t){i.postMessage({type:"result",id:e.data.id,data:{result:"error",error:{code:"unusableItem",message:t instanceof Error?t.message:"Unknown error"}}})}r&&r.close(),l(null);break;default:i.postMessage({type:"result",id:e.data.id,data:{result:"error",error:{code:"unsupportedCommand",message:o.command}}})}}}}d.setAttribute("type","hidden"),d.setAttribute("name","access_token"),d.setAttribute("value",a),c.appendChild(d),r.document.body.append(c),c.submit(),window.addEventListener("message",function(t){if(t.source&&t.source===r){let a=t.data;"initialize"===a.type&&a.channelId===e.messaging.channelId&&((i=t.ports[0]).addEventListener("message",o),i.start(),i.postMessage({type:"activate"}))}})}},[a,n,i,t]);return{openOneDrivePicker:(0,x.useCallback)(()=>{o.logEvent("attach-dropdown-onedrive-picker-opened"),p()},[p,o]),connectOneDrive:m}}({accessToken:Y,uploadThirdPartyFile:M}),en=()=>(0,n.jsxs)(o.Xi,{className:"flex flex-row pr-3 py-2.5 gap-2",onClick:W?ee:Q,children:[(0,n.jsx)(_.Z,{size:16,className:"opacity-70"}),W?F("attach-dropdown.google-drive","Add from Google Drive"):F("attach-dropdown.connect-google-drive","Connect Google Drive")]}),es=()=>(0,n.jsxs)(o.Xi,{className:"flex flex-row pr-3 py-2.5 gap-2",onClick:Y?ea:et,children:[(0,n.jsx)(K.Mwr,{size:16,className:"opacity-70"}),Y?F("attach-dropdown.one-drive","Add from Microsoft OneDrive"):F("attach-dropdown.connect-one-drive","Connect Microsoft OneDrive")]}),er=(0,x.useCallback)(async(e,t)=>{let a=new File([new Blob([t],{type:"text/plain"})],e,{type:"text/plain"});await G([a]),P.logEvent("upload_file",void 0,{location:"add-text-content-upload",fileLength:t.length.toString()})},[G,P]),ei=()=>z&&O.length>0?O.map(e=>(0,n.jsx)(o.Xi,{className:"p-1",children:(0,n.jsx)(A.E.div,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"w-full max-w-64",children:(0,n.jsx)(q.j,{asset:e,fileName:e.name,metadata:(0,B.I)(e),onClick:I,onRemove:R,variant:"list-item"})})},e.assetId)):(0,n.jsx)(o.Xi,{className:"text-secondary cursor-default",disabled:!0,children:F("no-recent-files","No recent files")}),el=(0,n.jsxs)(o.AW,{align:"start",children:[(0,n.jsxs)(o.Xi,{className:"flex flex-row pr-3 py-2.5 gap-2",onClick:E,children:[(0,n.jsx)(T.Z,{size:16,className:"opacity-70"}),F("attach-dropdown.local","Upload a file")]}),V.ENABLE_ADD_TEXT_CONTENT&&(0,n.jsx)($,{onTextContentUpload:er}),V.ENABLE_GOOGLE_DRIVE&&(0,n.jsx)(en,{}),V.ENABLE_MICROSOFT_ONEDRIVE&&(0,n.jsx)(es,{}),(0,n.jsxs)(o.Ph,{children:[(0,n.jsxs)(o.kt,{className:"flex flex-row pr-3 py-2.5 gap-2",children:[(0,n.jsx)(Z.Z,{size:16,className:"opacity-70"}),F("attach-dropdown.recent","Recent")]}),(0,n.jsx)(o.cq,{children:(0,n.jsx)(o.TG,{sideOffset:8,className:"space-y-1",children:(0,n.jsx)(ei,{})})})]})]});return(0,n.jsxs)(o.h_,{children:[(0,n.jsx)(o.$F,{asChild:!0,disabled:p,children:(0,n.jsxs)(l.g$,{type:"button",variant:"outline","aria-label":m,disabled:p,size:b?"md":"iconMd",rounded:!0,className:(0,S.cn)("group/attach-button",b&&"w-full",L),tooltipProps:{disableHoverableContent:!0,delayDuration:p?100:600},tooltipContentProps:{side:"bottom",className:"bg-fg-primary text-background"},tooltipContent:b?void 0:m,tabIndex:0,children:[!h&&!!g&&(0,n.jsx)("span",{className:"absolute size-4 text-[11px] flex justify-center items-center font-medium rounded-full -right-1 -top-1 bg-primary text-background",children:g}),(0,n.jsx)(i.Uj,{className:"text-fg-secondary group-hover/attach-button:text-fg-primary transition-colors duration-100",size:18}),b&&m]})}),H?(0,n.jsx)(()=>{let[e,t]=(0,x.useState)("main");return(0,n.jsx)(o.AW,{align:"start",className:"w-64",children:"main"===e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.Xi,{className:"flex flex-row px-3 py-2.5 gap-2",onSelect:E,children:[(0,n.jsx)(T.Z,{size:16,className:"opacity-70"}),F("attach-dropdown.local","Upload a file")]}),V.ENABLE_GOOGLE_DRIVE&&(0,n.jsx)(en,{}),V.ENABLE_MICROSOFT_ONEDRIVE&&(0,n.jsx)(es,{}),(0,n.jsxs)(o.Xi,{className:"flex flex-row px-3 py-2.5 gap-2",onSelect:e=>{e.preventDefault(),t("recent")},children:[(0,n.jsx)(Z.Z,{size:16,className:"opacity-70"}),F("attach-dropdown.recent","Recent")]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.Xi,{className:"flex flex-row px-3 py-2.5 gap-2",onSelect:e=>{e.preventDefault(),t("main")},children:[(0,n.jsx)(D.Z,{size:16}),F("back","Back")]}),(0,n.jsx)(ei,{})]})})},{}):el]})}},80296:function(e,t,a){a.d(t,{t:function(){return y}});var n=a(584),s=a(62339),r=a(16505),i=a(22852),l=a(89576),o=a(48600),c=a(16199),d=a(7263),u=a(54063),m=a(73929),p=a(67989),x=a(76140),f=a(50240),h=a(66070),g=a(95397),b=a(31416);function v(e){let{conversation:t,onEditStart:a,onDeleteStart:r,onToggleFavorite:o}=e,{t:c}=(0,h.$G)("base"),u=(0,l.w)(),m=(0,g.g)(),p=(0,f.useCallback)(e=>{e.stopPropagation(),window.open("/chat/".concat(t.conversationId),"_blank")},[t.conversationId]),x=(0,f.useCallback)(e=>{e.stopPropagation(),null==o||o(t.conversationId)},[o,t.conversationId]),v=(0,f.useCallback)(e=>{e.stopPropagation(),a(t.conversationId)},[a,t.conversationId]),y=(0,f.useCallback)(e=>{e.stopPropagation(),r(t.conversationId)},[r,t.conversationId]);return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[!u&&(0,n.jsx)(i.g$,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:p,tooltipContent:c("New Tab","New Tab"),"aria-label":c("New Tab","New Tab"),children:(0,n.jsx)(s.Lf,{size:16,className:"text-primary"})}),m.SHOW_FAVORITE_BUTTON&&o?(0,n.jsx)(i.g$,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:x,tooltipContent:t.starred?c("Un-star","Un-star"):c("Star","Star"),"aria-label":t.starred?c("Un-star","Un-star"):c("Star","Star"),children:(0,n.jsx)(b.Z,{size:16,className:(0,d.cn)(t.starred&&"fill-primary")})}):null,(0,n.jsx)(i.g$,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:v,tooltipContent:c("Rename","Rename"),"aria-label":c("Rename","Rename"),children:(0,n.jsx)(s.Mw,{size:16,className:"text-primary"})}),(0,n.jsx)(i.g$,{tabIndex:-1,variant:"ghost",size:"iconSm","aria-label":c("Delete","Delete"),onClick:y,tooltipContent:c("Delete","Delete"),children:(0,n.jsx)(s.XH,{size:16,className:"text-primary"})})]})}function y(e){let{conversation:t,highlight:a,matchType:s,matchedWords:i,timeRange:c,isEditing:u,isDeleting:m,isSelected:p,isCurrent:g,newTitle:b,onNewTitleChange:y,onSelect:S,onEditStart:E,onDeleteStart:I,onToggleFavorite:_,onEditSave:T,onDeleteConfirm:Z,onCancel:D,className:A}=e,{t:O}=(0,h.$G)("base"),K=(0,l.w)(),z=(0,f.useMemo)(()=>t.title?t.title:t.createTime?O("conversation-missing-title","Chat on {{date}}",{date:new Date(t.createTime).toLocaleDateString()}):O("Untitled Chat","Untitled Chat"),[t,O]),R=(0,f.useMemo)(()=>"MATCH_MESSAGE"===s&&!!a,[s,a]),M=(0,f.useCallback)(()=>{T(t.conversationId)},[T,t.conversationId]),L=(0,f.useCallback)(e=>{e.stopPropagation(),"Enter"===e.key?M():"Escape"===e.key&&D()},[M,D]),G=(0,f.useCallback)(()=>{Z(t.conversationId)},[Z,t.conversationId]),{personaById:F}=(0,o.HG)(),P=(0,f.useMemo)(()=>{if(!(0,o.VO)(t.personaId))return;let e=F[t.personaId];if(e)return{...e,...(0,r.DB)(e.personaId)}},[t.personaId,F]),H=(0,f.useCallback)(e=>{!S||1===e.button||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),S(t.conversationId))},[S,t.conversationId]);return(0,n.jsxs)(n.Fragment,{children:[!u&&(0,n.jsx)(x.default,{href:"/chat/".concat(t.conversationId),className:"col-start-1 col-end-2 row-start-1 row-end-2 block z-10",onClick:H}),(0,n.jsxs)("div",{className:(0,d.cn)("flex cursor-pointer items-center gap-2 px-3 col-start-1 col-end-2 row-start-1 row-end-2",A),children:[u?(0,n.jsx)("input",{className:"w-full bg-transparent focus-visible:outline-none",value:b,onKeyDown:L,autoFocus:!0,onChange:e=>{y(e.target.value)}}):(0,n.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[P&&(0,n.jsx)("span",{className:(0,d.cn)("[&>svg]:h-4 [&>svg]:w-4",P.colorClassName),children:P.icon}),(0,n.jsx)("div",{className:"truncate text-primary",children:"MATCH_TITLE"===s?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||0===t.length||"string"!=typeof e)return e;let a=t.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),s=RegExp("(".concat(a,")"),"gi"),r=e.split(s);return 1===r.length?e:r.map((e,t)=>t%2==1?(0,n.jsx)("span",{className:"text-primary font-extrabold",children:e},t):e)}(z,i):z}),g&&(0,n.jsx)(w,{children:O("Current","Current")})]}),R&&(0,n.jsx)(N,{text:a,matchedWords:i||[],className:"text-xs text-secondary mt-0.5 truncate"})]}),(0,n.jsx)("div",{className:"z-20",children:(p||K)&&!u&&!m?(0,n.jsx)(v,{conversation:t,onEditStart:E,onDeleteStart:I,onToggleFavorite:_}):u?(0,n.jsx)(j,{onCancel:D,onSave:M}):m?(0,n.jsx)(k,{onCancel:D,onConfirm:G}):(0,n.jsx)(C,{conversation:t,timeRange:c})})]})]})}function w(e){let{children:t}=e;return(0,n.jsx)("span",{className:(0,d.cn)("border border-border-l2 px-2 rounded-full","text-sm text-secondary flex flex-row items-center gap-1 text-nowrap"),children:t})}function j(e){let{onCancel:t,onSave:a}=e,{t:r}=(0,h.$G)("base");return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(i.g$,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:e=>{e.stopPropagation(),t()},tooltipContent:r("Cancel","Cancel"),"aria-label":r("Cancel","Cancel"),children:(0,n.jsx)(s.b0,{size:16,className:"text-fg-primary"})}),(0,n.jsx)(i.g$,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:e=>{e.stopPropagation(),a()},tooltipContent:r("Save","Save"),"aria-label":r("Save","Save"),children:(0,n.jsx)(p.Z,{size:16,className:"text-primary"})})]})}function k(e){let{onCancel:t,onConfirm:a}=e,{t:r}=(0,h.$G)("base");return(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(i.g$,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:e=>{e.stopPropagation(),t()},tooltipContent:r("Cancel","Cancel"),"aria-label":r("Cancel","Cancel"),children:(0,n.jsx)(s.b0,{size:16,className:"text-fg-primary"})}),(0,n.jsx)(i.g$,{tabIndex:-1,variant:"ghost",size:"iconSm",onClick:e=>{e.stopPropagation(),a()},tooltipContent:r("Delete","Delete"),"aria-label":r("Delete","Delete"),children:(0,n.jsx)(s.XH,{size:16,className:"text-red-400"})})]})}function C(e){let{conversation:t,timeRange:a}=e,s=(0,f.useMemo)(()=>{if(t.modifyTime||t.createTime)return function(e,t){let a=new Date(e);if("this-year"===t)return a.toLocaleDateString(m.ZP.language,{day:"numeric",month:"short"});if("older"===t)return a.toLocaleDateString(m.ZP.language,{day:"numeric",month:"short",year:"numeric"});{let t=(0,u.U)(e,new Date,{unit:"day",locale:"en"}),a="day";return"today"===t&&(a=void 0),"yesterday"===t&&(a="hour"),(0,c.Z)((0,u.U)(e,new Date,{unit:a,locale:m.ZP.language}))}}(t.modifyTime||t.createTime,a)},[t.modifyTime,t.createTime,a]);return s?(0,n.jsx)("span",{className:(0,d.cn)("text-secondary whitespace-nowrap ml-2 hidden text-sm","md:inline md:group-hover/item:hidden","md:group-focus/item:hidden md:group-active/item:hidden"),children:s}):null}function N(e){let{text:t,matchedWords:a,className:s}=e;if(!t||!(null==a?void 0:a.length))return(0,n.jsx)(n.Fragment,{children:t});let r=a.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),i=RegExp("(".concat(r,")"),"gi"),l=t.split(i);return(0,n.jsx)("div",{className:s,children:l.map((e,t)=>a.some(t=>t.toLowerCase()===e.toLowerCase())?(0,n.jsx)("span",{className:(0,d.cn)("text-primary font-bold"),children:e},t):(0,n.jsx)(f.Fragment,{children:e},t))})}},61090:function(e,t,a){a.d(t,{v:function(){return f}});var n=a(584),s=a(22852),r=a(78174),i=a(95397),l=a(98526),o=a(7263),c=a(22838),d=a(90496),u=a(55608),m=a(50240),p=a(66070),x=a(13642);function f(e){let{value:t,onChange:a,isDirty:f,placeholder:h,onSave:g,onReset:b,disabled:v,textareaId:y}=e,w=(0,m.useRef)(null),{t:j}=(0,p.$G)("settings"),k=(0,m.useCallback)(e=>{a(e.target.value)},[a]),C=(0,m.useRef)(t);C.current=t;let N=(0,m.useCallback)(()=>{g(C.current)},[g]);(0,l.y)(r.FG,()=>{N()},[N]);let S=(0,m.useCallback)(()=>{b()},[b]);(0,m.useEffect)(()=>{w.current&&!v&&w.current.focus()},[v]);let E=(0,i.g)(),I=(0,m.useMemo)(()=>Number(E.MAX_CUSTOM_INSTRUCTIONS_LENGTH.value.maxLength),[]),_=(0,m.useMemo)(()=>t.length>I,[t,I]),T=(0,m.useMemo)(()=>{let e=Number(E.MAX_CUSTOM_INSTRUCTIONS_LENGTH.value.maxLength);return!!e&&t.length>Math.floor(.8*e)},[t,I]);return(0,n.jsxs)("div",{className:"relative flex flex-col gap-3",children:[(0,n.jsx)("div",{className:(0,o.cn)("w-full transition ease-in-out rounded-xl","border border-toggle-border",v&&"opacity-50"),children:(0,n.jsx)(x.Z,{ref:w,className:(0,o.cn)("w-full p-3 text-sm align-bottom bg-transparent focus:outline-none text-primary rounded-xl"),value:t,onChange:k,placeholder:h,style:{resize:"none"},minRows:4,maxRows:8,disabled:v,id:y})}),(0,n.jsxs)("div",{className:"flex flex-row justify-between gap-2 px-0 min-h-10",children:[(0,n.jsxs)("div",{className:(0,o.cn)("flex flex-row items-center gap-1 text-xs",_?"text-red-500":T?"text-secondary opacity-100":"opacity-0"),children:[(0,n.jsxs)("span",{children:[t.length," / ",I]}),_&&(0,n.jsx)("span",{className:"flex flex-row items-center gap-1",children:(0,n.jsx)(c.Z,{className:"size-4 shrink-0"})})]}),(0,n.jsx)(d.M,{children:f&&(0,n.jsxs)(u.E.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0,transition:{duration:.15}},exit:{opacity:0,y:-5,transition:{duration:.15}},className:(0,o.cn)("flex flex-row justify-end gap-2"),children:[(0,n.jsx)(s.zx,{variant:"ghostSecondary",size:"md",onClick:S,children:j("Discard","Discard")}),(0,n.jsx)(s.zx,{variant:"primary",size:"md",onClick:N,children:j("Save","Save")})]})})]})]})}},89680:function(e,t,a){a.d(t,{S:function(){return r}});var n=a(24638);a(50240);var s=a(33417);class r extends s.SV{componentDidCatch(e,t){super.componentDidCatch(e,t),(0,n.H)(t.componentStack||"no stack info",e.message)}constructor(e){super(e)}}},39890:function(e,t,a){a.d(t,{_:function(){return l}});var n=a(584),s=a(47457),r=a(76140),i=a(50240);let l=e=>{let{title:t,description:a,cta:l}=e,{routeToConversation:o}=(0,s.o)(),c=(0,i.useCallback)(()=>{o(void 0)},[]);return(0,n.jsx)("div",{className:"w-full h-full flex justify-center items-center",children:(0,n.jsxs)("div",{className:"flex flex-col max-w-xl text-center items-center justify-center px-4",children:[(0,n.jsx)("div",{className:"text-3xl font-medium",children:t}),(0,n.jsx)("div",{className:"mt-6 text-secondary",children:a}),(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsx)(r.default,{href:"/",onClick:c,className:"focus:outline-none focus-visible:ring-1 focus-visible:ring-ring py-2 px-3 rounded-lg bg-button-secondary hover:bg-button-secondary-hover",children:l})})]})})}},42246:function(e,t,a){a.d(t,{u:function(){return r}});var n=a(584),s=a(7263);function r(e){let{children:t,className:a="",fadeSize:r="sm"}=e;return(0,n.jsx)("div",{className:(0,s.cn)("flex-1 flex flex-col gap-1 h-full overflow-y-auto py-1",{sm:"[mask-image:linear-gradient(to_bottom,transparent,black_4px,black_calc(100%_-_4px),transparent)] [-webkit-mask-image:linear-gradient(to_bottom,transparent,black_4px,black_calc(100%_-_4px),transparent)]",md:"[mask-image:linear-gradient(to_bottom,transparent,black_8px,black_calc(100%_-_8px),transparent)] [-webkit-mask-image:linear-gradient(to_bottom,transparent,black_8px,black_calc(100%_-_8px),transparent)]",lg:"[mask-image:linear-gradient(to_bottom,transparent,black_16px,black_calc(100%_-_16px),transparent)] [-webkit-mask-image:linear-gradient(to_bottom,transparent,black_16px,black_calc(100%_-_16px),transparent)]"}[r],a),tabIndex:-1,children:t})}},66244:function(e,t,a){a.d(t,{T:function(){return i}});var n=a(584),s=a(50240),r=a(98678);function i(e){let{metadata:t,onRemoveFile:a,file:i,allowCompact:l=!1}=e,o=t instanceof Error,c=(0,s.useMemo)(()=>t&&!o?t.fileName||"":i?i.name:"Unknown",[t,o]),d=(0,s.useCallback)(()=>{i&&a&&a(i)},[i,a]);return(0,n.jsx)(r.j,{allowCompact:l,fileName:c,localFile:i,metadata:t,onRemove:d})}},64640:function(e,t,a){a.d(t,{$1:function(){return eB},mO:function(){return eU},O9:function(){return eA},ci:function(){return eD}});var n=a(584),s=a(17492),r=a(88700),i=a(31416),l=a(73702),o=a(7854),c=a(88746),d=a(27147),u=a(63771),m=a(37027),p=a(81106),x=a(71321),f=a(8236),h=a(53703),g=a(2327),b=a(5425),v=a(92844),y=a(50265),w=a(78531),j=a(69498),k=a(16666),C=a(5844),N=a(54193),S=a(45183),E=a(90589),I=a(94690),_=a(16365),T=a(44282),Z=a(497),D=a(75445),A=a(39449),O=a(52414),K=a(47290),z=a(84892),R=a(72431),M=a(91100),L=a(25880),G=a(98682),F=a(18570),P=a(63222),H=a(65961),U=a(35645),$=a(49338),B=a(87011),q=a(35683),W=a(64909),Y=a(84866),V=a(87252),X=a(38188),Q=a(2449),J=a(30155),ee=a(4550),et=a(57494),ea=a(91653),en=a(77745),es=a(26930),er=a(19748),ei=a(49455),el=a(38789),eo=a(73455),ec=a(85574),ed=a(99328),eu=a(61461),em=a(46604),ep=a(33565),ex=a(13199),ef=a(90116),eh=a(73833),eg=a(32990),eb=a(41022),ev=a(28745),ey=a(44473),ew=a(24702),ej=a(16030),ek=a(86160),eC=a(76584),eN=a(86283),eS=a(558),eE=a(70025),eI=a(34627),e_=a(24135),eT=a(73271),eZ=a(66070);let eD={flag:s.Z,home:r.Z,star:i.Z,heart:l.Z,globe:o.Z,unlock:c.Z,smile:d.Z,shield:u.Z,bell:m.Z,mail:p.Z,phone:x.Z,user:f.Z,stethoscope:h.Z,calendar:g.Z,clock:b.Z,hourglass:v.Z,sun:y.Z,moon:w.Z,monitor:j.Z,umbrella:k.Z,leaf:C.Z,utensils:N.Z,bug:S.Z,fish:E.Z,bird:I.Z,cat:_.Z,"flask-conical":T.Z,rocket:Z.Z,plane:D.Z,car:A.Z,truck:O.Z,train:K.Z,camera:z.Z,video:R.Z,music:M.Z,headphones:L.Z,microscope:G.Z,archive:F.Z,"book-open":P.Z,zap:H.Z,wrench:U.Z,"sticky-note":$.Z,"cup-soda":B.Z,scale:q.Z,film:W.Z,palette:Y.Z,cpu:V.Z,calculator:X.Z,laptop:Q.Z,briefcase:J.Z,highlighter:ee.Z,"clipboard-list":et.Z,component:ea.Z,building:en.Z,flame:es.Z,play:er.Z,diamond:ei.Z,database:el.Z,aperture:eo.Z,glasses:ec.Z,shirt:ed.Z,banana:eu.Z,beer:em.Z,apple:ep.Z,carrot:ex.Z,cherry:ef.Z,gem:eh.Z,gamepad:eg.Z,"chef-hat":eb.Z,music2:ev.Z,"dollar-sign":ey.Z,coffee:ew.Z,tag:ej.Z,sailboat:ek.Z,"graduation-cap":eC.Z,anchor:eN.Z,pin:eS.Z,compass:eE.Z,code:eI.Z,droplet:e_.Z,box:eT.Z},eA=["gray","red","orange","yellow","lime","teal","green","blue","purple","pink"],eO={flag:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.flag.name",defaults:"Flag"}),home:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.home.name",defaults:"Home"}),star:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.star.name",defaults:"Star"}),heart:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.heart.name",defaults:"Heart"}),globe:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.globe.name",defaults:"Globe"}),unlock:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.unlock.name",defaults:"Unlock"}),smile:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.smile.name",defaults:"Smile"}),shield:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.shield.name",defaults:"Shield"}),bell:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.bell.name",defaults:"Bell"}),mail:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.mail.name",defaults:"Mail"}),phone:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.phone.name",defaults:"Phone"}),user:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.user.name",defaults:"User"}),stethoscope:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.stethoscope.name",defaults:"Stethoscope"}),calendar:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.calendar.name",defaults:"Calendar"}),clock:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.clock.name",defaults:"Clock"}),hourglass:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.hourglass.name",defaults:"Hourglass"}),sun:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.sun.name",defaults:"Sun"}),moon:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.moon.name",defaults:"Moon"}),monitor:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.monitor.name",defaults:"Monitor"}),umbrella:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.umbrella.name",defaults:"Umbrella"}),leaf:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.leaf.name",defaults:"Leaf"}),utensils:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.utensils.name",defaults:"Utensils"}),bug:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.bug.name",defaults:"Bug"}),fish:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.fish.name",defaults:"Fish"}),bird:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.bird.name",defaults:"Bird"}),cat:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.cat.name",defaults:"Cat"}),"flask-conical":(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.flask-conical.name",defaults:"Flask Conical"}),rocket:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.rocket.name",defaults:"Rocket"}),plane:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.plane.name",defaults:"Plane"}),car:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.car.name",defaults:"Car"}),truck:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.truck.name",defaults:"Truck"}),train:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.train.name",defaults:"Train"}),camera:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.camera.name",defaults:"Camera"}),video:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.video.name",defaults:"Video"}),music:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.music.name",defaults:"Music"}),headphones:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.headphones.name",defaults:"Headphones"}),microscope:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.microscope.name",defaults:"Microscope"}),archive:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.archive.name",defaults:"Archive"}),"book-open":(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.book-open.name",defaults:"Book Open"}),zap:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.zap.name",defaults:"Zap"}),wrench:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.wrench.name",defaults:"Wrench"}),"sticky-note":(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.sticky-note.name",defaults:"Sticky Note"}),"cup-soda":(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.cup-soda.name",defaults:"Cup Soda"}),scale:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.scale.name",defaults:"Scale"}),film:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.film.name",defaults:"Film"}),palette:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.palette.name",defaults:"Palette"}),cpu:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.cpu.name",defaults:"CPU"}),calculator:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.calculator.name",defaults:"Calculator"}),laptop:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.laptop-2.name",defaults:"Laptop"}),briefcase:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.briefcase.name",defaults:"Briefcase"}),highlighter:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.highlighter.name",defaults:"Highlighter"}),"clipboard-list":(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.clipboard-list.name",defaults:"Clipboard List"}),component:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.component.name",defaults:"Component"}),building:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.building-2.name",defaults:"Building"}),flame:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.flame.name",defaults:"Flame"}),play:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.play.name",defaults:"Play"}),diamond:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.diamond.name",defaults:"Diamond"}),database:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.database.name",defaults:"Database"}),aperture:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.aperture.name",defaults:"Aperture"}),glasses:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.glasses.name",defaults:"Glasses"}),shirt:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.shirt.name",defaults:"Shirt"}),banana:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.banana.name",defaults:"Banana"}),beer:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.beer.name",defaults:"Beer"}),apple:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.apple.name",defaults:"Apple"}),carrot:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.carrot.name",defaults:"Carrot"}),cherry:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.cherry.name",defaults:"Cherry"}),gem:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.gem.name",defaults:"Gem"}),gamepad:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.gamepad-2.name",defaults:"Gamepad"}),"chef-hat":(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.chef-hat.name",defaults:"Chef Hat"}),music2:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.music-2.name",defaults:"Music Note"}),"dollar-sign":(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.dollar-sign.name",defaults:"Dollar Sign"}),coffee:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.coffee.name",defaults:"Coffee"}),tag:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.tag.name",defaults:"Tag"}),sailboat:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.sailboat.name",defaults:"Sailboat"}),"graduation-cap":(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.graduation-cap.name",defaults:"Graduation Cap"}),anchor:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.anchor.name",defaults:"Anchor"}),pin:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.pin.name",defaults:"Pin"}),compass:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.compass.name",defaults:"Compass"}),code:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.code-2.name",defaults:"Code"}),droplet:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.droplet.name",defaults:"Droplet"}),box:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"icon.box.name",defaults:"Box"})},eK={gray:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.gray.name",defaults:"Gray"}),red:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.red.name",defaults:"Red"}),orange:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.orange.name",defaults:"Orange"}),yellow:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.yellow.name",defaults:"Yellow"}),lime:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.lime.name",defaults:"Lime"}),teal:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.teal.name",defaults:"Teal"}),green:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.green.name",defaults:"Green"}),blue:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.blue.name",defaults:"Blue"}),purple:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.purple.name",defaults:"Purple"}),pink:(0,n.jsx)(eZ.cC,{ns:"base",i18nKey:"color.pink.name",defaults:"Pink"})};var ez=a(7263),eR=a(50240),eM=a(22852),eL=a(33158),eG=a(89576),eF=a(81828);let eP={gray:"text-gray-400",red:"text-red-400",orange:"text-orange-400",yellow:"text-yellow-400",lime:"text-lime-400",teal:"text-teal-400",green:"text-green-400",blue:"text-blue-400",purple:"text-purple-400",pink:"text-pink-400"},eH={gray:"text-gray-300",red:"text-red-300",orange:"text-orange-300",yellow:"text-yellow-300",lime:"text-lime-300",teal:"text-teal-300",green:"text-green-300",blue:"text-blue-300",purple:"text-purple-300",pink:"text-pink-300"},eU=(0,eR.memo)(e=>{let{value:t,className:a,size:s}=e,{resolvedTheme:r}=(0,eF.F)(),i="dark"===r,l=eD[t.icon],o=(0,ez.cn)("size-4",i&&eH[t.color],i||eP[t.color],a);return(0,n.jsx)(l,{className:o,size:s})}),e$=(0,eR.memo)(e=>{let{icon:t,onSelect:a}=e,s=(0,eG.w)(),[r,i]=(0,eR.useState)(!1),l=eD[t],o=s?"iconMd":"iconSm",c=e=>{i(!1),a({icon:t,color:e})};return(0,n.jsxs)(eL.J2,{modal:!0,open:r,onOpenChange:i,children:[(0,n.jsx)(eL.xo,{asChild:!0,children:(0,n.jsxs)(eM.zx,{variant:"ghost",size:"iconSm",children:[(0,n.jsx)("label",{className:"sr-only",children:eO[t]}),(0,n.jsx)(l,{className:"size-4"})]})}),(0,n.jsx)(eL.yk,{className:"grid grid-cols-5 p-2",align:"start",alignOffset:-9,children:eA.map(e=>(0,n.jsxs)(eM.zx,{size:o,variant:"ghost",overideIconStyle:!0,onClick:()=>c(e),children:[(0,n.jsx)("label",{className:"sr-only",children:eK[e]}),(0,n.jsx)(eU,{value:{icon:t,color:e}})]},e))})]},t)}),eB=(0,eR.memo)(e=>{let{onSelect:t,className:a}=e,s=(0,eR.useMemo)(()=>Object.keys(eD).sort(),[]),r=(0,ez.cn)("grid grid-cols-9 items-center justify-items-stretch p-2 ",a);return(0,n.jsx)("div",{className:r,children:s.map(e=>(0,n.jsx)("div",{className:"aspect-square flex items-center justify-center",children:(0,n.jsx)(e$,{icon:e,onSelect:t})},e))})})},16505:function(e,t,a){a.d(t,{DB:function(){return T},Ye:function(){return _},oe:function(){return Z}});var n=a(584),s=a(19922),r=a(22852),i=a(47457),l=a(48600),o=a(7263),c=a(72930),d=a(57750),u=a(32088),m=a(31144),p=a(8236),x=a(97294),f=a(53703),h=a(73082),g=a(14358),b=a(73702),v=a(11239),y=a(94956),w=a(44282),j=a(78854),k=a(9354),C=a(50240),N=a(66070),S=a(81827),E=a(79972),I=a(85682);let _=e=>{let{handleSend:t}=e,{t:a}=(0,N.$G)("base"),{personas:f}=(0,l.HG)(),{user:h}=(0,E.kP)(),{client:g}=(0,u.useStatsigClient)(),b=(0,c.t)(k.Z("list")),{routeToConversation:v}=(0,i.o)(),y=(0,s.gK)(k.Z("setReasoningMode")),{stage:w}=(0,S.Bn)(),j=(0,d.F)(k.Z("setShowAgeVerification")),_=(0,C.useCallback)(e=>{if(l.Mh.includes(e.personaId)&&"pass"!==w&&!h){j(!0);return}y("none");let{initialQuery:n,toolOverrides:s,addToLastChat:r}=Z(e.personaId,a);if(g.logEvent("click_persona",e.personaId,{location:"persona-pill"}),r){let t=b.filter(t=>t.personaId===e.personaId).sort((e,t)=>new Date(t.modifyTime).getTime()-new Date(e.modifyTime).getTime())[0];if(t){v(t.conversationId);return}}t(n,void 0,void 0,s,!1,e)},[y,t,b,j,w,h,g,v,a]),D=f.filter(e=>"news"!==e.personaId),A=f.find(e=>"news"===e.personaId);return(0,n.jsxs)(n.Fragment,{children:[A&&(0,n.jsxs)(r.zx,{variant:"outline",rounded:!0,onClick:()=>_(A),children:[(0,n.jsx)(m.Z,{size:16,strokeWidth:2,className:"text-secondary"}),A.name]}),(0,n.jsxs)(I.h_,{onOpenChange:e=>{e&&g.logEvent("click_persona_pill",void 0,{location:"persona-pill"})},children:[(0,n.jsx)(I.$F,{tabIndex:-1,className:"focus:outline-none group",children:(0,n.jsxs)(r.zx,{variant:"outline",rounded:!0,children:[(0,n.jsx)(p.Z,{size:18,strokeWidth:2,className:"text-secondary"}),a("persona-pill.label","Personas"),(0,n.jsx)(x.Z,{className:"text-secondary group-data-[state=open]:rotate-180 transition-rotate duration-200",size:12})]})}),(0,n.jsx)(I.AW,{align:"start",side:"bottom",className:"min-w-36 space-y-0.5",children:D.map(e=>{let{icon:t,colorClassName:a}=T(e.personaId);return(0,n.jsxs)(I.Xi,{onClick:()=>_(e),className:"cursor-pointer flex items-center gap-1 ps-1.5",children:[(0,n.jsx)("span",{className:(0,o.cn)("[&>svg]:h-4",a),children:t}),(0,n.jsx)("span",{children:e.name})]},e.personaId)})})]})]})};function T(e){switch(e){case"news":return{icon:(0,n.jsx)(m.Z,{}),colorClassName:"text-gray-400 dark:text-gray-300"};case"doctor":return{icon:(0,n.jsx)(f.Z,{}),colorClassName:"text-purple-400 dark:text-purple-300"};case"friend":return{icon:(0,n.jsx)(h.Z,{}),colorClassName:"text-orange-400 dark:text-orange-300"};case"tutor":return{icon:(0,n.jsx)(g.Z,{}),colorClassName:"text-green-400 dark:text-green-300"};case"romance":return{icon:(0,n.jsx)(b.Z,{}),colorClassName:"text-pink-400 dark:text-pink-300"};case"unhinged":return{icon:(0,n.jsx)(v.Z,{}),colorClassName:"text-yellow-300 dark:text-yellow-300"};case"therapist":return{icon:(0,n.jsx)(y.Z,{}),colorClassName:"text-teal-400 dark:text-teal-300"};case"scientist":return{icon:(0,n.jsx)(w.Z,{}),colorClassName:"text-blue-400 dark:text-blue-300"};case"coder":return{icon:(0,n.jsx)(j.Z,{}),colorClassName:"text-lime-400 dark:text-lime-300"};default:throw Error("Unknown personaId: ".concat(e))}}function Z(e,t){let a={webSearch:!1,xSearch:!1,xMediaSearch:!1,trendsSearch:!1,xPostAnalyze:!1,imageGen:!1};switch(e){case"news":return{toolOverrides:{webSearch:!0,xSearch:!0,xMediaSearch:!0,trendsSearch:!0,xPostAnalyze:!0,imageGen:!1},initialQuery:t("Tell me the latest news.","Tell me the latest news."),addToLastChat:!1,hideDeepSearch:!1,hideThinking:!1};case"doctor":return{toolOverrides:a,initialQuery:t("Hi, what can you help me with?","Hi, what can you help me with?"),addToLastChat:!0,hideDeepSearch:!1,hideThinking:!1,disclaimer:t("Grok is not a doctor. Please consult one. Don't share personal information that will identify you.","Grok is not a doctor. Please consult one. Don't share personal information that will identify you.")};case"friend":return{toolOverrides:a,initialQuery:t("hey, how was your day?","hey, how was your day?"),addToLastChat:!0,hideDeepSearch:!0,hideThinking:!0};case"tutor":return{toolOverrides:a,initialQuery:t("Hey, can you help me with a homework question?","Hey, can you help me with a homework question?"),addToLastChat:!0,hideDeepSearch:!1,hideThinking:!1};case"romance":return{toolOverrides:{webSearch:!1,xSearch:!1,xMediaSearch:!1,trendsSearch:!1,xPostAnalyze:!1},initialQuery:t("Hey, love. How are you?","Hey, love. How are you?"),addToLastChat:!0,hideDeepSearch:!0,hideThinking:!0,disclaimer:t("Some content may be sexual in nature.","Some content may be sexual in nature.")};case"unhinged":return{toolOverrides:a,initialQuery:t("Drop a funny hot take.","Drop a funny hot take."),addToLastChat:!0,hideDeepSearch:!0,hideThinking:!0,disclaimer:t("Content will be objectionable, inappropriate, and offensive.","Content will be objectionable, inappropriate, and offensive.")};case"therapist":return{toolOverrides:a,initialQuery:t("Hi, what can you help me with?","Hi, what can you help me with?"),addToLastChat:!0,hideDeepSearch:!1,hideThinking:!1,disclaimer:t("Grok is not a therapist. Please consult one. Don't share personal information that will identify you.","Grok is not a therapist. Please consult one. Don't share personal information that will identify you.")};case"scientist":case"coder":return{toolOverrides:a,initialQuery:t("Hello, what do you do?","Hello, what do you do?"),addToLastChat:!0,hideDeepSearch:!1,hideThinking:!1};default:!function(e){throw Error("Wrong persona id: "+e)}(e)}}},11270:function(e,t,a){a.d(t,{c:function(){return n}});let n="max-w-[51rem]"},89036:function(e,t,a){a.d(t,{B:function(){return es}});var n=a(584),s=a(19922),r=a(62339),i=a(50240),l=a(95397),o=a(12405),c=a(98526),d=a(11270),u=a(78174),m=a(86867),p=a(3210),x=a(38164),f=a(89576),h=a(51544),g=a(36194),b=a(48600),v=a(50253),y=a(29997);function w(e){return/^(https?:\/\/)/.test(e)?e:"https://"+e}var j=a(24638),k=a(6623),C=a(7263),N=a(72930),S=a(46751),E=a(57750),I=a(32088),_=a(55608),T=a(90496),Z=a(9354),D=a(41662),A=a(66070),O=a(13642),K=a(99406),z=a(86173),R=a(66244),M=a(16505),L=a(79972),G=a(36424),F=a(80402),P=a(8521);function H(e){let{text:t,isShown:a,className:s=""}=e,r=(0,i.useId)();return(0,n.jsx)(T.M,{children:a&&(0,n.jsx)(_.E.span,{layout:!0,initial:{opacity:0,width:4},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:4},transition:{duration:.1,ease:"easeInOut"},className:"inline-block whitespace-nowrap ".concat(s),children:t},r)})}var U=a(23310),$=a(88499),B=a(22852),q=a(85682);function W(e){var t,a;let{model:o,personaSettings:c,isDeepsearchSelected:d,reasoningMode:u,deepsearchDisabled:m,forceShowLabel:p=!0,showLabel:x=!1}=e,f=(0,l.g)(),{client:h}=(0,I.useStatsigClient)(),{t:g}=(0,A.$G)("base"),b=(0,s.gK)(Z.Z("isDeepSearchRateLimited")),y=(0,s.gK)(Z.Z("isDeeperSearchSelected")),w=(0,s.gK)(Z.Z("setIsDeeperSearchSelected")),{data:j}=(0,v.Pd)(),[k,N]=(0,i.useState)(!1);(0,i.useEffect)(()=>{f.SHOW_DEEPER_SEARCH&&!k&&setTimeout(()=>{N(!0)},1e3)},[f.SHOW_DEEPER_SEARCH,k]);let S=(0,i.useMemo)(()=>"deepersearch"===u||y?"DeeperSearch":"DeepSearch",[u]),E=(0,i.useMemo)(()=>y?g("deepsearch-option.deepersearch.description","Extended search, more reasoning"):g("deepsearch-option.deepsearch.description","Advanced search and reasoning"),[y]),T=(0,i.useCallback)(e=>{e.stopPropagation();let t=s.gK.getState().setReasoningMode,a=d?"none":y?"deepersearch":"deepsearch";h.logEvent("switch_reasoning_mode",a),t(a)},[h,d,y]),D=(0,i.useCallback)(()=>{let{setReasoningMode:e}=s.gK.getState();e("deepsearch"),w(!1),h.logEvent("switch_reasoning_mode","deepsearch")},[h,y,w,u]),O=(0,i.useCallback)(()=>{let{setReasoningMode:e}=s.gK.getState();e("deepersearch"),w(!0),h.logEvent("switch_reasoning_mode","deepersearch")},[h,y,w,u]);if(!o)return null;let K=null===(t=o.tags)||void 0===t?void 0:t.includes("deepsearch"),z=null===(a=o.tags)||void 0===a?void 0:a.includes("always_show_deepsearch");return c&&c.hideDeepSearch||!K&&!z?null:(z&&!K||b)&&(null==j?void 0:j.hasSubscriptions)?(0,n.jsxs)(B.g$,{tooltipAsChild:!0,className:(0,C.cn)("group/ds-toggle"),variant:"outline",rounded:!0,onClick:()=>{(0,U._.getState().setIsUpselling)(!0)},tooltipProps:{disableHoverableContent:!0,delayDuration:0},tooltipContent:g("Go Super to use DeepSearch","Go Super to use DeepSearch"),tooltipContentProps:{side:"bottom",className:"bg-primary text-background"},disabled:f.DISABLE_RESEARCH_TOGGLE,"aria-pressed":d,children:[(0,n.jsx)(r.Go,{size:18,className:(0,C.cn)("text-fg-secondary group-hover/ds-toggle:text-fg-primary",d&&"text-fg-primary")}),p&&(0,n.jsx)("span",{children:g("DeepSearch","DeepSearch")})]},"search"):f.SHOW_DEEPER_SEARCH?(0,n.jsxs)(_.E.div,{layout:"size",className:(0,C.cn)("flex ring-1 rounded-full items-center max-h-[40px]","box-border","transition-colors duration-100","relative overflow-hidden","ring-inset","ring-border-l2",d&&"bg-button-ghost-active hover:bg-button-ghost-active"),transition:{duration:k?.2:0,ease:"easeInOut"},children:[(0,n.jsxs)(B.g$,{tooltipContent:E,tooltipProps:{disableHoverableContent:!0,delayDuration:600},tooltipContentProps:{side:"bottom",className:"bg-primary text-background"},className:(0,C.cn)("group/ds-toggle","transition-colors duration-100 focus-visible:ring-transparent","box-border","relative overflow-hidden","rounded-r-none pr-3","bg-transparent","hover:bg-button-ghost-hover","focus-visible:bg-button-ghost-hover"),variant:"none",rounded:!0,onClick:T,disabled:f.DISABLE_RESEARCH_TOGGLE||m,tabIndex:0,"aria-pressed":d,"aria-label":S,children:[y?(0,n.jsx)($.Z,{size:18,className:(0,C.cn)("text-fg-secondary group-hover/ds-toggle:text-fg-primary",d&&"text-fg-primary")}):(0,n.jsx)(r.Go,{isOn:d,size:18,className:(0,C.cn)("text-fg-secondary group-hover/ds-toggle:text-fg-primary",d&&"text-fg-primary")}),p?(0,n.jsx)("span",{children:S}):(0,n.jsx)(H,{className:"max-w-full truncate text-xs",text:S,isShown:x})]},"search"),(0,n.jsx)("div",{className:"h-4 w-[1px] bg-toggle-border focus:outline-none",tabIndex:-1}),(0,n.jsxs)(q.h_,{children:[(0,n.jsx)(q.$F,{asChild:!0,children:(0,n.jsx)(B.zx,{className:(0,C.cn)("transition-colors duration-100","relative overflow-hidden ","focus-visible:ring-transparent","rounded-l-none pl-2 pr-3","bg-transparent","hover:bg-button-ghost-hover","focus-visible:bg-button-ghost-hover"),variant:"none",rounded:!0,"aria-label":g("deepsearch-dropdown-button.label","Change mode"),children:(0,n.jsx)(r.v4,{size:12,className:"text-fg-secondary"})})}),(0,n.jsxs)(q.AW,{side:"bottom",align:"end",children:[(0,n.jsxs)(q.bO,{checked:!y,className:"flex flex-col items-start justify-center",onSelect:D,children:[(0,n.jsx)("span",{children:g("DeepSearch","DeepSearch")}),(0,n.jsx)("span",{className:"text-fg-secondary",children:g("deepsearch-option.deepsearch.description","Advanced search and reasoning")})]},"deepsearch-item"),(0,n.jsxs)(q.bO,{checked:y,onSelect:O,className:"flex flex-col items-start justify-center","aria-label":"DeeperSearch",children:[(0,n.jsx)("span",{children:g("DeeperSearch","DeeperSearch")}),(0,n.jsx)("span",{className:"text-secondary",children:g("deepsearch-option.deepersearch.description","Extended search, more reasoning")})]},"deepersearch-item")]})]})]}):(0,n.jsxs)(B.g$,{tooltipAsChild:!0,className:(0,C.cn)("group/ds-toggle","border border-border-l2","overflow-hidden","items-center justify-center",!x&&!p&&"px-[9px]",d?"bg-button-ghost-active hover:bg-button-ghost-active":"bg-transparent hover:bg-button-ghost-hover"),variant:"none",rounded:!0,onClick:T,tooltipProps:{disableHoverableContent:!0,delayDuration:600},tooltipContent:g("Advanced search and reasoning","Advanced search and reasoning"),tooltipContentProps:{side:"bottom",className:"bg-primary text-background"},disabled:f.DISABLE_RESEARCH_TOGGLE||m,tabIndex:0,"aria-pressed":d,"aria-label":S,children:[(0,n.jsx)(r.Go,{isOn:d,size:18,className:(0,C.cn)("text-fg-secondary group-hover/ds-toggle:text-fg-primary",d&&"text-fg-primary")}),p?(0,n.jsx)("span",{children:S}):(0,n.jsx)(H,{className:"max-w-full truncate text-xs",text:S,isShown:x})]},"search")}var Y=a(67926);let V=e=>{let{onClick:t=()=>{}}=e,a=(0,f.w)();(0,i.useEffect)(()=>{if(a)return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[a])};var X=a(48269),Q=a(32643),J=a(23214),ee=a(39955),et=a(57791);function ea(){var e;let t=(0,l.g)(),{t:a}=(0,A.$G)("base"),{data:o}=(0,v.Pd)(),[c,d]=(0,x._)("model-select-tutorial",!1),{client:u}=(0,I.useStatsigClient)(),{models:m,unavailableModels:p,modelById:f,isPending:h}=(0,g.bP)(),b=(0,U._)(Z.Z("setIsUpselling")),y=(0,s.gK)(Z.Z("activeModelId")),w=(0,s.gK)(Z.Z("setActiveModelId")),k=(0,s.gK)(Z.Z("outputMode")),N=(0,s.gK)(Z.Z("setOutputMode")),S=(0,s.gK)(Z.Z("reasoningMode"));V({onClick:()=>d(!0)});let E=(0,i.useCallback)(e=>{u.logEvent("set_model",e,{location:"query-bar"}),w(e)},[u]),_=(0,i.useCallback)(()=>{if(null==o?void 0:o.hasSubscriptions){b(!0);return}},[]),T=(0,i.useMemo)(()=>{if(h)return Y.jd;let e=f[y];if(!e){(0,j.H)("model-select:ModelSelect:prettyActiveModelName","Model ID ".concat(y," not found."));let e=Object.values(f)[0];return e?(w(e.modelId),e.name||Y.jd):Y.jd}return e.name||Y.jd},[f,y,h]),D=(0,i.useCallback)(e=>{let a;e.preventDefault(),a=t.TOGGLE_SEARCH_ONLY?"noSearch"===k?"auto":"noSearch":"modelOnly"===k?"auto":"modelOnly",u.logEvent("switch_tools",a),N(a)},[k]),[O,K]=(0,i.useState)(!1),z=(0,i.useMemo)(()=>m.some(e=>e.modelId.startsWith("grok-3")),[m]),R=(0,i.useCallback)(e=>{c||d(!0),K(e)},[c]),M=(0,i.useId)(),{isUpselling:L}=(0,U._)(),G="deepsearch"===S||"auto"===(e=k)||"image"===e||"search"===e;return(0,n.jsxs)(q.h_,{open:O,onOpenChange:R,children:[(0,n.jsx)(q.$F,{asChild:!0,children:(0,n.jsxs)(B.g$,{className:"border border-border-l2 sm:border-0",variant:"ghost",rounded:!0,tooltipProps:{open:z&&!c&&!L},tooltipContentProps:{side:"bottom",align:"end",className:et.vq},tooltipContent:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(X.Eh,{className:"fill-primary"}),(0,n.jsx)("p",{className:"text-sm font-semibold",children:a("Grok 3 Enabled","Grok 3 Enabled")}),(0,n.jsx)("p",{className:"text-xs text-primary-foreground/60",children:a("You have the most powerful model available","You have the most powerful model available")})]}),children:[(0,n.jsx)("span",{className:"inline-block text-primary text-xs @[400px]/input:text-sm",children:T}),(0,n.jsx)(r.v4,{className:"size-3 text-secondary transition-transform ".concat(O&&"rotate-180")})]})}),(0,n.jsxs)(q.AW,{side:"bottom",align:"end",sideOffset:6,alignOffset:-5,className:"flex flex-col",children:[p.map(e=>(0,n.jsxs)(q.Xi,{className:(0,C.cn)("group/output-mode cursor-pointer flex-col items-start",{"no-siblings-highlighted":e.modelId===y}),onClick:_,children:[(0,n.jsxs)("div",{className:"flex items-center w-full gap-2",children:[(0,n.jsx)("span",{className:"font-medium text-primary",children:e.name||e.modelId}),(0,n.jsx)(Q.C,{className:"text-primary",variant:"outline",children:a("SuperGrok Only","SuperGrok Only")})]}),(0,n.jsx)("span",{className:"text-sm text-secondary",children:e.description})]},e.modelId)),m.map(e=>{var t,a;return(0,n.jsxs)(q.Xi,{className:(0,C.cn)("group/output-mode cursor-pointer flex-col items-start",{"no-siblings-highlighted":e.modelId===y}),onClick:()=>E(e.modelId),children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[(0,n.jsx)("span",{className:"font-semibold text-primary",children:e.name||e.modelId}),(null===(t=e.badgeText)||void 0===t?void 0:t.trim())&&(0,n.jsx)("div",{className:"px-[5px] rounded-full text-[10px] text-secondary bg-[#D6DAE3] dark:bg-white/10",children:null===(a=e.badgeText)||void 0===a?void 0:a.trim()})]}),(0,n.jsx)("span",{className:"text-sm text-secondary",children:e.description})]},e.modelId)}),m.length>0?(0,n.jsx)(J.Z,{className:"my-2 self-center w-[90%] bg-secondary/25"}):null,(0,n.jsxs)("div",{className:"min-w-64 flex flex-row items-center justify-between px-3 py-2",role:"menuitem",children:[(0,n.jsxs)("div",{className:"flex flex-col items-start text-xs",children:[(0,n.jsx)("span",{className:"text-xs font-semibold text-primary",id:M,children:t.TOGGLE_SEARCH_ONLY?a("Enable Search","Enable Search"):a("Enable Search and Images","Enable Search and Images")}),(0,n.jsx)("span",{className:"mr-2 text-xs text-secondary",children:"deepsearch"===S?a("Auto-enabled for DeepSearch","Auto-enabled for DeepSearch"):"modelOnly"===k||"noSearch"===k?a("Answer without a web search","Answer without a web search"):a("Grok can browse the web","Grok can browse the web")})]}),(0,n.jsx)(ee.r,{"aria-labelledby":M,checked:G,onClick:D,className:"deepsearch"===S?"opacity-30 cursor-not-allowed":void 0})]})]})]})}function en(e){var t,a;let{model:i,personaSettings:o,isThinkSelected:c,thinkDisabled:d,forceShowLabel:u=!0,showLabel:m=!1}=e,p=(0,l.g)(),{client:x}=(0,I.useStatsigClient)(),{t:f}=(0,A.$G)("base"),h=(0,s.gK)(Z.Z("isThinkingRateLimited")),{data:g}=(0,v.Pd)();if(!i)return;let b=null===(t=i.tags)||void 0===t?void 0:t.includes("think"),y=null===(a=i.tags)||void 0===a?void 0:a.includes("always_show_think");return o&&o.hideDeepSearch||!b&&!y?void 0:(y&&!b||h)&&(null==g?void 0:g.hasSubscriptions)?(0,n.jsxs)(B.g$,{tooltipAsChild:!0,variant:"outline",size:m||u?"md":"iconMd",rounded:!0,onClick:()=>{(0,U._.getState().setIsUpselling)(!0)},tooltipProps:{disableHoverableContent:!0,delayDuration:0},tooltipContent:f("Go Super to use Think","Go Super to use Think"),tooltipContentProps:{side:"bottom",className:"bg-surface-invert text-fg-invert"},disabled:p.DISABLE_RESEARCH_TOGGLE,"aria-pressed":c,"aria-label":f("Think","Think"),children:[(0,n.jsx)(r.WG,{size:18,className:"text-fg-secondary"}),(0,n.jsx)("span",{className:"hidden @[600px]/input:inline-block",children:f("Think","Think")})]},"search"):(0,n.jsxs)(B.g$,{tooltipAsChild:!0,className:(0,C.cn)("group/think-toggle","transition-colors duration-100","relative overflow-hidden border",!m&&!u&&"px-[9px]",c&&"bg-button-ghost-active hover:bg-button-ghost-active"),variant:"outline",size:m||u?"md":"iconMd",rounded:!0,onClick:()=>{let e=s.gK.getState().setReasoningMode,t=c?"none":"think";x.logEvent("switch_reasoning_mode",t),e(t)},tooltipProps:{disableHoverableContent:!0,delayDuration:600},tooltipContent:f("Let the model take its time","Let the model take its time"),tooltipContentProps:{side:"bottom",className:"bg-primary text-background"},disabled:p.DISABLE_THINK_TOGGLE||d,tabIndex:0,"aria-pressed":c,"aria-label":"Think",children:[(0,n.jsx)(r.WG,{isOn:c,size:18,className:"".concat(c?"text-primary":"group-hover/think-toggle:text-fg-primary text-fg-secondary")}),u?(0,n.jsx)("span",{children:"Think"}):(0,n.jsx)(H,{className:"max-w-full truncate text-xs",text:"Think",isShown:m})]},"reason")}let es=(0,i.forwardRef)((e,t)=>{let{id:a,className:H,textAreaClassName:U,onQuery:$=er,streamState:B,onAbort:q=er,disabled:Y,enterSubmit:V=!0,onKeyDown:X,onChange:Q,placeholder:J,onFrontPage:ee=!1,isIncognito:et,expandable:es=!0}=e,{t:el}=(0,A.$G)("base"),{user:eo}=(0,L.kP)(),{client:ec}=(0,I.useStatsigClient)(),{attachFiles:ed,detachFile:eu}=(0,o.G)(),em=(0,s.gK)(Z.Z("conversationId")),ep=(0,s.gK)(Z.Z("defaultAnonModelId")),ex=(0,s.gK)(Z.Z("defaultFreeModelId")),ef=(0,s.gK)(Z.Z("defaultProModelId")),eh=(0,s.gK)(Z.Z("setDefaultAnonModelId")),eg=(0,s.gK)(Z.Z("setDefaultFreeModelId")),eb=(0,s.gK)(Z.Z("setDefaultProModelId")),ev=(0,l.g)(),[ey,ew]=(0,x._)("model-select-tutorial",!1),{scrollRef:ej,className:ek}=(0,m.m)(),eC=(0,i.useRef)(null),eN=(0,i.useRef)(null),eS=(0,i.useRef)(null),[eE,eI]=function(){let[e,t]=(0,i.useState)(0),a=(0,i.useRef)(null);return(0,i.useLayoutEffect)(()=>{let e=()=>{a.current&&t(a.current.getBoundingClientRect().width)};if(e(),window.addEventListener("resize",e),a.current){let t=new ResizeObserver(()=>{e()});return t.observe(a.current),()=>{window.removeEventListener("resize",e),t.disconnect()}}},[]),[a,e]}(),e_=eI>400,eT=eI>470,eZ=(0,h.r)(),eD=(0,f.w)(),[eA,eO]=(0,i.useState)(!1);(0,i.useImperativeHandle)(t,()=>({getTextArea:()=>eN.current}));let eK=em||"no_conversation_id",{register:ez,handleSubmit:eR,formState:{errors:eM}}=(0,D.cI)(),{ref:eL,...eG}=ez("files",{validate:e=>!(eQ.length+((null==e?void 0:e.length)||0)>y.gt)||"".concat(el("Max number of files allowed is","Max number of files allowed is")," ").concat(y.gt)}),eF=(0,s.gK)(Z.Z("queryByConversationId")),eP=(0,s.gK)(Z.Z("idsetQueryByConversationId")),eH=eF[eK],eU=(0,i.useCallback)(e=>eP(e,eK),[eK]);(0,i.useEffect)(()=>{eN.current&&(eN.current.value=eF[eK]||"")},[eK]);let e$=(0,s.gK)(Z.Z("setActiveModelId")),{isThinkSelected:eB,isDeepsearchSelected:eq}=(0,g.NK)(),eW=(0,s.gK)(Z.Z("reasoningMode")),eY=(0,S.O)(Z.Z("listByConversationId")),eV=(0,S.O)(Z.Z("attachListByConversationId")),eX=(0,S.O)(Z.Z("delistAttachByConversationId")),eQ=eY[eK]||ei,eJ=eV[eK]||ei,{attachedUrls:e0,handleAttachUrl:e1,handleDetachUrl:e2,handleDetachAll:e4}=function(){let e=(0,l.g)(),[t,a]=(0,i.useState)(new Set),n=(0,i.useCallback)(t=>{let n=w(t);a(t=>!e.ENABLE_WEBPAGE_ATTACHMENTS||t.size>=y.Ag?t:new Set([...t,n]))},[e.ENABLE_WEBPAGE_ATTACHMENTS]),s=(0,i.useCallback)(e=>{let t=w(e);a(e=>{let a=new Set(e);return a.delete(t),a})},[]),r=(0,i.useCallback)(()=>{a(new Set)},[]);return{attachedUrls:(0,i.useMemo)(()=>[...t],[t]),handleAttachUrl:n,handleDetachUrl:s,handleDetachAll:r}}(),e8=(0,i.useCallback)(e=>{ec.logEvent("detach-url",e,{location:"query-bar",url:e}),e2(e)},[]),e5=(0,s.gK)(Z.Z("activeModelId")),e6=(0,s.gK)(Z.Z("queryBarExpanded")),e3=!es||e6,e9=(0,s.gK)(Z.Z("setQueryBarExpanded")),e7=(0,s.gK)(Z.Z("setIsTypingDebounce")),te=(0,i.useMemo)(()=>!!ee||!!eH&&eH.length>0||e3,[eH,ee,e3]),tt="error"===B,ta="optimistic"===B||"streaming"===B||"reconnecting"===B,tn=(0,G.N)(Z.Z("inEditId")),[ts,tr]=(0,i.useState)(!1),ti=(0,i.useMemo)(()=>{var e;let t=eQ.some(e=>void 0===e.metadata),a=eQ.some(e=>e.metadata instanceof Error),n=!!eH||eQ.length>0||(null===(e=eV[eK])||void 0===e?void 0:e.length)>0;return!t&&!a&&!ts&&n&&!Y},[eQ,Y,ta,ts,eH,eV,eK]),tl=(0,i.useCallback)(async()=>{var e,t,a;if(!ti)return;(ta||tt)&&await q();let n=null!==(t=null===(e=eN.current)||void 0===e?void 0:e.value.length)&&void 0!==t?t:0;if(n>y.dI)return K.Am.error(el("query-bar.too-long","Character Limit Exceeded: {{currentLength, number(maximumFractionDigits: 0)}}/{{maxLength, number(maximumFractionDigits: 0)}}",{maxLength:y.dI.toFixed(0),currentLength:n.toFixed(0)})),!1;if(!eN.current)return;let s=S.O.getState(),r=eN.current.value,i=eQ.map(e=>e.metadata).filter(e=>e&&!(e instanceof Error)),l=[...null!==(a=eV[eK])&&void 0!==a?a:[]],o=[...i.map(e=>e.fileMetadataId),...l.map(e=>e.assetId)];eU(""),eN.current.value="",s.removeByConversationId(eK),s.removeAttachByConversationId(eK),e4(),tr(!0),await $(r||el("Refer to the following content:","Refer to the following content:"),o,e0,void 0,!1).finally(()=>tr(!1))||(eU(r),eN.current&&(eN.current.value=r),eQ.map(e=>s.lisertByConversationId(e,eK)),l.map(e=>s.lisertAttachByConversationId(e,eK)))},[$,eU,ti,ta,tt,q,eQ,eV,eK,e0]),to=eR((0,i.useCallback)(async()=>{if(!eA){eO(!0);try{await tl()}catch(e){(0,j.H)("query-bar:submit",e)}eO(!1)}},[eA,tl])),tc=(0,i.useCallback)(e=>{e.preventDefault(),to().catch(e=>{(0,j.H)("query-bar:handleSubmit",e)})},[to]);(0,c.y)(u.FG,()=>{to().catch(e=>{(0,j.H)("query-bar:hotkeys",e)})},[to]);let td=(0,N.t)(e=>em?e.byId[em]:void 0),tu=(0,i.useMemo)(()=>{if(td&&(0,b.VO)(td.personaId))return(0,M.oe)(td.personaId,el)},[td]);(0,i.useEffect)(()=>{let e=e=>{var t,a;if(!e.metaKey&&!e.ctrlKey&&!e.altKey&&!e.repeat&&"Tab"!==e.key&&"Enter"!==e.key&&"Shift"!==e.key&&void 0===tn){if((null===(t=document.activeElement)||void 0===t?void 0:t.tagName)==="INPUT"||(null===(a=document.activeElement)||void 0===a?void 0:a.tagName)==="TEXTAREA")return;/[a-zA-Z0-9]/.test(e.key)&&ee&&eN.current&&eN.current.focus()}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[ee,tn]);let tm=function(e){let t=(0,p.D)(),a=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{if(!t||!e.current)return;let n=()=>{a.current=!0},s=()=>{setTimeout(()=>{a.current=!1},50)};return e.current.addEventListener("compositionstart",n),e.current.addEventListener("compositionend",s),()=>{var t,a;null===(t=e.current)||void 0===t||t.removeEventListener("compositionstart",n),null===(a=e.current)||void 0===a||a.removeEventListener("compositionend",s)}},[e,t]),a}(eN),tp=(0,i.useCallback)(e=>{let t=!e.metaKey&&!e.ctrlKey&&!e.shiftKey,a=!e.nativeEvent.isComposing&&"Process"!==e.key&&"KeyZ"!==e.code&&!tm.current;if("Enter"===e.key&&t&&a&&V&&!eZ){e.preventDefault(),to().catch(e=>{(0,j.H)("query-bar:handleKeyDown",e)});return}null==X||X(e)},[V,X,to,eZ]),tx=(0,i.useRef)(null),tf=(0,i.useCallback)(e=>{var t;ey||ew(!0),eU(null===(t=eN.current)||void 0===t?void 0:t.value),e9(!0),null==Q||Q(e),e7(!0),tx.current&&clearTimeout(tx.current),tx.current=setTimeout(()=>{e7(!1)},600)},[Q,eU,e7,ey]),th=(0,i.useCallback)(()=>{var e;null===(e=eS.current)||void 0===e||e.click()},[]),tg=(0,i.useCallback)(e=>{if(!e.target.files)return;let t=Array.from(e.target.files);ed(t),t.forEach(e=>{ec.logEvent("upload_file",e.name,{location:"file-attach-button",mimeType:e.type})})},[ed,ec]),tb=(0,i.useCallback)(e=>{eu(eS,e)},[eS,eu]),tv=(0,i.useCallback)(e=>{eX(eK,e.assetId)},[eK]),ty=(0,i.useCallback)(()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{ref:e=>{eL(e),eS.current=e},...eG,className:"hidden",type:"file",onChange:tg,multiple:!0}),eM.files&&(0,n.jsx)("div",{className:"text-red-500 absolute top-[-20px]",children:eM.files.message})]}),[eL,tg]),[tw,tj]=(0,i.useState)(0),tk=(0,i.useMemo)(()=>Array.isArray(J)?J[tw]:J,[J,tw]);(0,i.useEffect)(()=>{},[String(J),!1]);let tC=(0,i.useCallback)(()=>{var e;e9(!0),null===(e=eN.current)||void 0===e||e.focus()},[]),{modelById:tN,defaultAnonModelId:tS,defaultFreeModelId:tE,defaultProModelId:tI,isPending:t_}=(0,g.bP)(),{data:tT}=(0,v.Pd)(),tZ=ev.HIDE_SUBSCRIPTION_FLOWS_FROM_PREMIUM_PLUS_USERS&&(null==eo?void 0:eo.xSubscriptionType)==="PremiumPlus"||(null==tT?void 0:tT.hasSubscriptions);(0,i.useEffect)(()=>{var e;if(!t_&&!e5&&tN[e5]){if(ef!==tI&&tZ&&tI&&tN[tI]){eb(tI),e$(tI);return}if(ex!==tE&&eo&&tE&&tN[tE]){eg(tE),e$(tE);return}if(ep!==tS&&tS&&tN[tS]){eh(tS),e$(tS);return}e$(null===(e=Object.values(tN)[0])||void 0===e?void 0:e.modelId)}},[t_,e5,tN,tS,tE,tI,eo]);let tD=!eo,tA=e0.length+eQ.length+eJ.length,tO=null==tN?void 0:tN[e5],{isAttachDisabled:tK,isThinkDisabled:tz,isDeepsearchDisabled:tR}=(0,g.NK)(tO),tM=(0,E.F)(e=>e.userSettings.preferences.autoDetectWebpageAttachments),tL=(0,i.useCallback)(e=>{if(tK)return;let t=[],a=e.clipboardData.getData("text"),n=a.trim();if(ev.ENABLE_WEBPAGE_ATTACHMENTS&&tM&&(0,k.p)(n)&&(e1(n),ec.logEvent("attach_url",n,{location:"query-bar-paste",url:n})),ev.STORE_LONG_PASTES_AS_FILES&&a.length>102400){let e=new File([new Blob([a],{type:"text/plain"})],"pasted-text.txt",{type:"text/plain"});t.push(e)}let s=e.clipboardData.items;if(s)for(let e=0;e<s.length;e++){let a=s[e].getAsFile();a&&t.push(a)}t.length>0&&(e.preventDefault(),ed(t),t.forEach(e=>{ec.logEvent("upload_file",e.name,{location:"file-paste",mimeType:e.type})}))},[ed,ec,ev,tK,e1]),tG=tD?el("Please login to attach files","Please login to attach files"):tK?el("Attachments are disabled for this mode","Attachments are disabled for this mode"):el("Attach","Attach");return(0,n.jsx)("form",{id:a,className:(0,C.cn)("sticky bottom-0","w-full text-base flex flex-col gap-2 items-center justify-center relative z-10",H),onSubmit:to,children:(0,n.jsxs)("div",{ref:eC,onClick:tC,className:(0,C.cn)("flex flex-row gap-2 justify-center w-full relative",ee?"@xl:w-4/5":""),children:[ty(),(0,n.jsxs)("div",{ref:eE,className:(0,C.cn)("query-bar group","bg-surface-l2","ring-border-l1 hover:ring-border-l2 focus-within:ring-border-l2 hover:focus-within:ring-border-l2","duration-100 relative w-full overflow-hidden @container/input","shadow shadow-black/5",d.c,"ring-1 ring-inset focus-within:ring-1",{"pb-12 px-2 @[480px]/input:px-3 rounded-3xl":te,"px-12 pb-0 rounded-[40px]":!te,"bg-purple-50 ring-purple-200":et,"hover:ring-purple-300 focus-within:ring-purple-300 hover:focus-within:ring-purple-300":et,"dark:bg-purple-1000 dark:ring-purple-700":et,"dark:hover:ring-purple-600 dark:focus-within:ring-purple-600 dark:hover:focus-within:ring-purple-600":et}),children:[(0,n.jsx)(_.E.div,{ref:ej,initial:{translateY:-10,opacity:0},animate:{translateY:0,opacity:1},exit:{translateY:-10,opacity:0},className:(0,C.cn)("w-full flex flex-row gap-2 mt-3 px-1 whitespace-nowrap",{hidden:!(tA>0&&e3),"flex-wrap":!eD,"overflow-x-auto":eD},ek),children:(0,n.jsxs)(T.M,{initial:!1,mode:"popLayout",children:[e0.map((e,t)=>(0,n.jsx)(_.E.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},transition:{duration:.2},children:(0,n.jsx)(F.X,{url:e,onDetachUrl:e8,isErrored:!1})},e+t)),eQ.map((e,t)=>(0,n.jsx)(_.E.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},transition:{duration:.2},children:(0,n.jsx)(R.T,{file:e.file,metadata:e.metadata,onRemoveFile:tb,allowCompact:!0})},e.file.name+t)),eJ.map((e,t)=>(0,n.jsx)(_.E.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},children:(0,n.jsx)(P.k,{asset:e,onRemoveAsset:tv,allowCompact:!0})},e.assetId+t))]})}),(0,n.jsxs)("div",{className:"relative z-10",children:[(0,n.jsx)("span",{className:(0,C.cn)("absolute px-2 @[480px]/input:px-3 py-5 text-fg-secondary pointer-events-none select-none",eH||!tk?"hidden":""),children:tk}),(0,n.jsx)(O.Z,{ref:eN,dir:"auto","aria-label":el("Ask Grok anything","Ask Grok anything"),className:(0,C.cn)("w-full px-2 @[480px]/input:px-3",e3?"pt-5 mb-5":"my-5","bg-transparent","focus:outline-none","text-fg-primary","align-bottom",U),style:{resize:"none"},onFocus:()=>e9(!0),onKeyDown:tp,onChange:tf,onClick:()=>{ey||ew(!0)},value:eH,maxRows:te?eD?4:12:1,autoFocus:!0,minRows:1,onPaste:tL})]}),(0,n.jsxs)("div",{className:"flex gap-1.5 absolute inset-x-0 bottom-0 border-2 border-transparent p-2 @[480px]/input:p-2 max-w-full",children:[(0,n.jsx)(z.R,{label:tG,disabled:tD||tK,queryBarExpanded:e3,totalFileCount:tA,handleClickUpload:th}),(0,n.jsxs)(_.E.div,{animate:te?{opacity:1,translateY:0}:{opacity:0,translateY:40},className:"".concat(te?"":"pointer-events-none"," flex grow gap-1.5 max-w-full"),children:[(0,n.jsx)("div",{className:"grow flex gap-1.5 max-w-full",children:(0,n.jsxs)(T.M,{children:[(0,n.jsx)(W,{model:tO,personaSettings:tu,isDeepsearchSelected:eq,reasoningMode:eW,isIncognito:et,deepsearchDisabled:tR,forceShowLabel:eT,showLabel:eq&&e_},"1"),(0,n.jsx)(en,{model:tO,personaSettings:tu,isThinkSelected:eB,isIncognito:et,thinkDisabled:tz,forceShowLabel:eT,showLabel:eB&&e_},"2")]})}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(ea,{})})]}),(0,n.jsxs)("div",{className:(0,C.cn)("ml-auto flex flex-row items-end gap-1"),children:[!ta&&(0,n.jsx)(_.E.button,{initial:{opacity:.5},animate:{opacity:1,transition:{duration:.1}},whileHover:ti?{scale:1.1}:void 0,whileTap:ti?{scale:.95}:void 0,className:(0,C.cn)("group flex flex-col justify-center rounded-full focus:outline-none focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"),type:"submit","aria-label":el("Submit","Submit"),disabled:!ti,onClick:tc,children:(0,n.jsx)("div",{className:(0,C.cn)("h-10 relative","aspect-square flex flex-col items-center justify-center","rounded-full ring-1 ring-inset duration-100","before:absolute before:inset-0 before:rounded-full before:bg-button-filled before:ring-0 before:transition-all duration-100",ti?"".concat(et?"bg-purple-500 dark:bg-purple-400":"bg-button-filled"," text-fg-invert ring-transparent before: before:[clip-path:circle(50%_at_50%_50%)]"):"".concat(et?"bg-warm-gray-200 dark:bg-gray-600":"bg-warm-gray-100 dark:bg-gray-600"," text-fg-secondary before:[clip-path:circle(0%_at_50%_50%)] ring-0")),children:(0,n.jsx)(r.Hf,{size:20,className:"relative"})})}),ta&&(0,n.jsx)(_.E.button,{whileTap:{scale:.95},initial:{scale:.95,opacity:1},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:.5,transition:{duration:.2}},className:(0,C.cn)("group flex flex-col justify-center rounded-full focus:outline-none focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring"),onClick:e=>{e.preventDefault(),q().catch(console.error)},children:(0,n.jsx)("div",{className:(0,C.cn)("h-10","aspect-square flex flex-col items-center justify-center rounded-full","rounded-full ring-1 ring-inset","bg-button-filled text-fg-invert"),children:(0,n.jsx)(r.nx,{})})})]})]})]}),ee&&et&&(0,n.jsx)(_.E.div,{initial:{translateY:-20,opacity:0},animate:{translateY:0,opacity:1},className:"absolute inset-x-0 rounded-full bottom-full sm:top-full start-0 text-fg-secondary",children:(0,n.jsxs)("div",{className:(0,C.cn)("py-4 sm:px-6 mx-auto flex flex-row items-start gap-1 text-sm",d.c),children:[(0,n.jsx)(r.L_,{size:16,className:"m-1 opacity-70 shrink-0"}),(0,n.jsx)("span",{className:"bg-surface-base",children:el("This chat is private and won't appear in your history or be used to train models. We may securely retain it for up to 30 days for safety purposes.","This chat is private and won't appear in your history or be used to train models. We may securely retain it for up to 30 days for safety purposes.")})]})})]})})}),er=async()=>!1,ei=[]},36424:function(e,t,a){a.d(t,{N:function(){return c}});var n=a(27435),s=a(13573),r=a(60542);let i={},l=void 0;class o{constructor(e,t){this.set=e,this.get=t,this.drawerOpen=!1,this.menuFixed=!0,this.menuHidden=!0,this.tabsCount=0,this.activeTabs=i,this.activeTempTabs=i,this.inEditId=l,this.setActiveTabs=(0,n.f0)(this.set,"activeTabs"),this.setActiveTempTabs=(0,n.f0)(this.set,"activeTempTabs"),this.addAnyTab=(e,t)=>{let a=this.get(),n={...a.activeTabs,...a.activeTempTabs};if(e in n)return;let s=Object.keys(n).reduce((e,t)=>({...e,[t]:{index:n[t].index+1}}),{[e]:{index:0}});this.set({activeTabs:Object.keys(a.activeTabs).reduce((e,t)=>({...e,[t]:{index:s[t].index}}),t?{}:{[e]:{index:0}}),activeTempTabs:Object.keys(a.activeTempTabs).reduce((e,t)=>({...e,[t]:{index:s[t].index}}),t?{[e]:{index:0}}:{})})},this.removeActiveTab=(0,n.Od)(this.set,"activeTabs"),this.removeActiveTempTab=(0,n.Od)(this.set,"activeTempTabs"),this.setDrawerOpen=(0,n.f0)(this.set,"drawerOpen"),this.toggleMenuFixed=(0,n.ZN)(this.set,"menuFixed"),this.setMenuFixed=(0,n.f0)(this.set,"menuFixed"),this.setMenuHidden=(0,n.f0)(this.set,"menuHidden"),this.setInEditId=(0,n.f0)(this.set,"inEditId")}}let c=(0,s.U)()((0,r.XR)((0,r.tJ)((e,t)=>new o(e,t),{name:"active-chat-tabs",storage:(0,r.FL)(()=>localStorage),partialize:e=>({activeTabs:e.activeTabs}),version:1})));(0,n.N7)(c,"activeTabs","tabsCount",e=>Object.keys(e).length+Object.keys(c.getState().activeTempTabs).length),(0,n.N7)(c,"activeTempTabs","tabsCount",e=>Object.keys(e).length+Object.keys(c.getState().activeTabs).length)},2103:function(e,t,a){a.d(t,{I:function(){return i}});var n=a(584),s=a(50240),r=a(7263);let i=s.forwardRef((e,t)=>{let{className:a,type:s,...i}=e;return(0,n.jsx)("input",{type:s,className:(0,r.cn)("flex h-9 w-full rounded-md border border-input-border bg-transparent px-3 py-1 text-sm shadow-sm file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...i})});i.displayName="Input"},33158:function(e,t,a){a.d(t,{J2:function(){return l},xo:function(){return o},yk:function(){return c}});var n=a(584),s=a(26184),r=a(50240),i=a(7263);let l=s.fC,o=s.xz;s.ee;let c=r.forwardRef((e,t)=>{let{className:a,align:l="center",sideOffset:o=4,noPortal:c=!1,...d}=e,u=c?r.Fragment:s.h_;return(0,n.jsx)(u,{children:(0,n.jsx)(s.VY,{ref:t,align:l,sideOffset:o,className:(0,i.cn)("z-50 bg-surface-l4 dark:bg-surface-l4 p-4 text-fg-primary shadow-sm shadow-black/5 border border-border-l1","outline-none data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2","data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","rounded-xl",a),...d})})});c.displayName=s.VY.displayName},84906:function(e,t,a){a.d(t,{O:function(){return r}});var n=a(584),s=a(7263);function r(e){let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-primary/10",t),...a})}},39955:function(e,t,a){a.d(t,{r:function(){return l}});var n=a(584),s=a(27734),r=a(50240),i=a(7263);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full","border-[1px] border-transparent transition-colors","focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring","focus-visible:ring-offset-2 focus-visible:ring-offset-background","ring-card-border ring-1","disabled:cursor-not-allowed disabled:opacity-50","data-[state=checked]:bg-primary data-[state=unchecked]:bg-dove","dark:data-[state=checked]:bg-ivory dark:data-[state=unchecked]:bg-button-secondary-selected",a),...r,ref:t,children:(0,n.jsx)(s.bU,{className:(0,i.cn)("pointer-events-none block h-4 w-4 rounded-full bg-white dark:bg-background shadow-lg ring-0 transition-transform","data-[state=unchecked]:translate-x-0 ms-0.5","data-[state=checked]:translate-x-5 rtl:data-[state=checked]:-translate-x-5","dark:data-[state=unchecked]:bg-overlay")})})});l.displayName=s.fC.displayName},80402:function(e,t,a){a.d(t,{X:function(){return m}});var n=a(584),s=a(22852),r=a(57791),i=a(6623),l=a(7263),o=a(65903),c=a(90517),d=a(50240),u=a(66070);function m(e){let{url:t,isErrored:a,onDetachUrl:m}=e,{t:p}=(0,u.$G)("base"),x=(0,d.useCallback)(()=>{t&&m&&m(t)},[t,m]);return(0,n.jsxs)(r.u,{delayDuration:300,children:[(0,n.jsx)(r.aJ,{asChild:!0,children:(0,n.jsxs)("div",{className:(0,l.cn)("flex flex-row items-center rounded-xl px-3 h-10 ","bg-chip text-sm","transition ease-in-out",m&&"pr-1.5",a&&"text-red-400"),children:[(0,n.jsxs)("a",{className:"flex flex-row items-center",href:t,target:"_blank",rel:"noopener noreferrer",children:[(0,n.jsx)(o.Z,{className:"!size-4 mr-2 shrink-0"}),(0,n.jsx)("span",{className:"truncate max-w-full sm:max-w-[250px]",children:(0,i.b)(t)})]}),m&&(0,n.jsx)(s.zx,{className:"rounded-full ml-1 p-0.5",variant:"ghost",size:"iconSm","aria-label":p("asset-chip-remove.label","Remove"),onClick:x,children:(0,n.jsx)(c.Z,{size:16})})]})}),(0,n.jsx)(r._v,{className:"max-w-2xl truncate",side:"bottom",children:t})]})}},72512:function(e,t,a){a.d(t,{ol:function(){return N},in:function(){return u.i},E:function(){return eO},TG:function(){return eU}});var n=a(584),s=a(75202),r=a(50240),i=a(7263);let l=(0,s.j)("rounded-3xl border text-card-foreground",{variants:{variant:{default:"bg-card",ghost:"bg-transparent"}},defaultVariants:{variant:"default"}}),o=r.forwardRef((e,t)=>{let{className:a,variant:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)(l({variant:s}),a),...r})});o.displayName="Card",r.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...s})}).displayName="CardHeader",r.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("font-semibold leading-none tracking-tight",a),...s})}).displayName="CardTitle",r.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})}).displayName="CardDescription",r.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...s})}).displayName="CardContent",r.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter";var c=a(65505),d=a(32088),u=a(55342),m=a(22852),p=a(85682),x=a(32235),f=a(84483),h=a(11653),g=a(66070),b=a(62339),v=a(74275),y=a(96059),w=a(54670),j=a(55029);let k=(0,r.memo)(e=>{let{workspaceId:t,open:a,onOpenChange:s,onDeleteStarted:r}=e,{t:l}=(0,g.$G)("workspace"),{mutate:o,error:c}=(0,w.Fi)(null!=t?t:"");return((0,y.c)(c),a)?(0,n.jsxs)(j.c,{open:a,setOpen:s,contentClassName:(0,i.cn)("focus:outline-0 focus-within:outline-0 gap-2","bg-background rounded-3xl","w-full md:w-5/6 lg:w-3/5 max-w-3xl","flex flex-col","md:overflow-hidden","px-6 py-6"),children:[(0,n.jsx)(v.fK,{children:(0,n.jsxs)(v.$N,{className:"flex justify-between",children:[l("workspace-detetion.title","Are you sure?"),(0,n.jsx)(m.zx,{className:"-mt-2 -mr-2",variant:"ghost",size:"icon","aria-label":l("workspace-instructions-close.label","Close"),onClick:()=>s(!1),tabIndex:-1,children:(0,n.jsx)(b.b0,{size:18,className:"text-secondary"})})]})}),(0,n.jsx)("div",{className:"text-secondary",children:l("workspace-deletion.description","This action cannot be undone. Workspace will be lost forever.")}),(0,n.jsxs)(v.cN,{className:"sm:justify-end pt-1",children:[(0,n.jsx)(m.zx,{onClick:()=>{s(!1)},variant:"ghost",size:"md",className:"text-secondary",children:l("workspace-deletion-cancel.label","Cancel")}),(0,n.jsxs)(m.zx,{onClick:()=>{null==r||r(),o()},variant:"outline",size:"md",className:"shadow-none text-primary",children:[(0,n.jsx)(h.Z,{className:"size-4 text-fg-danger"}),l("workspace-deletion-confirm.label","Delete workspace")]})]})]}):null});function C(e){let{workspace:t,className:a,iconSize:s,onDeleteStarted:l,onEditStarted:o}=e,{t:c}=(0,g.$G)("base"),{workspaceId:d}=t,[u,b]=(0,r.useState)(!1),v=(0,r.useCallback)(()=>{setTimeout(()=>{b(!0)},1)},[]),y=(0,i.cn)(a);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.h_,{children:[(0,n.jsx)(p.$F,{asChild:!0,children:(0,n.jsx)(m.zx,{variant:"ghostSecondary",rounded:!0,size:"iconMd",className:y,"aria-label":c("workspace-menu.label","Open menu"),children:(0,n.jsx)(x.Z,{size:null!=s?s:14})})}),(0,n.jsxs)(p.AW,{onCloseAutoFocus:e=>e.preventDefault(),side:"bottom",align:"end",sideOffset:6,alignOffset:-5,className:"flex flex-col shadow-sm shadow-black/5 border-border-l1 min-w-40",children:[o&&(0,n.jsxs)(p.Xi,{onClick:o,children:[(0,n.jsx)(f.Z,{size:16,className:"me-2"}),c("workspace-menu.rename.label","Rename")]}),(0,n.jsxs)(p.Xi,{onClick:v,children:[(0,n.jsx)(h.Z,{size:16,className:"text-fg-danger me-2"}),c("remove-workspace-button.label","Remove")]})]})]}),(0,n.jsx)(k,{workspaceId:d,open:u,onOpenChange:b,onDeleteStarted:l})]})}function N(e){let{workspace:t,onClick:a,className:s}=e,{name:r,icon:l,workspaceId:m}=t,{client:p}=(0,d.useStatsigClient)(),x=(0,i.cn)("group relative",s);return(0,n.jsxs)("div",{className:x,children:[(0,n.jsx)(c.r,{route:{page:"workspace",workspaceId:null!=m?m:"",tab:"attachments"},onClick:a,children:(0,n.jsxs)(o,{className:"flex flex-row items-center @sm:flex-col @sm:items-stretch gap-2 px-5 py-4 pe-12 @sm:pe-5 max-w-4/5 rounded-3xl hover:bg-surface-l1 shadow-none h-full overflow-hidden bg-none bg-transparent",children:[(0,n.jsx)(u.i,{icon:l,className:"size-4"}),(0,n.jsx)("div",{className:"text-sm font-medium truncate",children:r})]})}),(0,n.jsx)(C,{workspace:t,className:"visible @sm:invisible @sm:group-hover:visible absolute right-3 top-2 @sm:top-3",onDeleteStarted:()=>{p.logEvent("ws_delete_click",void 0,{location:"workspaces"})}})]})}var S=a(89680),E=a(39890),I=a(89036),_=a(47873),T=a(79663),Z=a(47457),D=a(95397),A=a(24638),O=a(57750),K=a(9354),z=a(19922);function R(e){let{children:t,delayMs:a=200}=e,[n,s]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=setTimeout(()=>{s(!0)},a);return()=>{clearTimeout(e)}},[a]),n?t:null}var M=a(42246),L=a(84906),G=a(66244),F=a(8521),P=a(5780),H=a(55608);function U(e){let{icon:t,title:a,subtitle:s,className:r}=e,l=(0,i.cn)("flex-1 flex flex-col items-center justify-center p-4 gap-4 mb-4",r);return(0,n.jsxs)(o,{variant:"ghost",className:l,children:[(0,n.jsx)("div",{className:"bg-surface-l1 flex flex-col items-center rounded-full p-4",children:(0,n.jsx)("span",{className:"text-fg-tertiary",children:t})}),(0,n.jsxs)("div",{className:"flex flex-col gap-1 items-center text-center",children:[(0,n.jsx)("h3",{className:"font-semibold text-lg",children:a}),(0,n.jsx)("span",{className:"text-secondary max-w-md",children:s})]})]})}function $(e){let{assets:t,uploadingFiles:a,onRemoveAsset:s,workspaceId:r}=e,i=(0,w.Ze)(r);return t.length+a.length+i.length===0?(0,n.jsx)(B,{}):(0,n.jsxs)("div",{className:"flex-1 flex flex-col gap-1 @sm:grid @sm:grid-cols-2 @sm:auto-rows-max",children:[a.map((e,t)=>(0,n.jsx)(H.E.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},children:(0,n.jsx)(G.T,{file:e,onRemoveFile:()=>{},metadata:void 0})},"file"+t)),i.map((e,t)=>(0,n.jsx)(H.E.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},children:(0,n.jsx)(G.T,{file:new File([e.thirdPartyFileId],e.name),onRemoveFile:()=>{},metadata:{fileMimeType:e.mimeType,fileName:e.name,thirdPartyFileId:e.thirdPartyFileId}})},"file"+t)),t.map((e,t)=>{var a;return(0,n.jsx)(H.E.div,{className:"max-w-full",initial:{opacity:0,translateY:-10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:-10},children:(0,n.jsx)(F.k,{asset:e,onRemoveAsset:s,labelClassName:"sm:max-w-full flex-1",hideEdit:!0})},null!==(a=e.assetId)&&void 0!==a?a:t)})]})}function B(){let{t:e}=(0,g.$G)("workspace");return(0,n.jsx)("div",{children:(0,n.jsx)(U,{icon:(0,n.jsx)(P.Z,{size:24,strokeWidth:1.5}),title:e("workspace-assets-empty.title","Welcome"),subtitle:e("workspace-assets-empty.text","Start by attaching files to your workspace. They will be used in all chats in this workspace.")})})}function q(e){var t,a;let{workspace:s}=e,r=null!==(t=s.workspaceId)&&void 0!==t?t:"",{data:i,isPending:l,isError:o,refetch:c}=(0,w.so)(r),d=(0,w.mx)(r),{mutate:u,error:m}=(0,w.qp)(r);if((0,y.c)(m),l)return(0,n.jsx)(W,{});if(o)return(0,n.jsx)(V,{onRefetch:c});let p=null!==(a=i.assets)&&void 0!==a?a:[];return(0,n.jsx)("section",{className:"flex-1 w-full h-full flex flex-col gap-2 relative",children:(0,n.jsx)(M.u,{fadeSize:"md",className:"py-2",children:(0,n.jsx)($,{workspaceId:r,uploadingFiles:d,assets:p,onRemoveAsset:e=>{e.assetId&&u(e.assetId)}})})})}function W(){return(0,n.jsx)(R,{children:(0,n.jsxs)("div",{"aria-busy":"true",className:"flex flex-col gap-2 @sm:grid @sm:grid-cols-2 @sm:auto-rows-max",children:[(0,n.jsx)(Y,{}),(0,n.jsx)(Y,{}),(0,n.jsx)(Y,{}),(0,n.jsx)(Y,{})]})})}function Y(){return(0,n.jsx)(L.O,{className:"bg-warm-gray-100 dark:bg-gray-900 h-10"})}function V(e){let{onRefetch:t}=e,{t:a}=(0,g.$G)("workspace");return(0,n.jsxs)(o,{className:"flex flex-col items-center px-8 py-4",variant:"ghost",children:[a("assets-loading-error.title","Unable to load assets"),(0,n.jsx)(m.zx,{variant:"outline",size:"md",onClick:t,children:a("assets-loading-error.cta","Retry")})]})}var X=a(86173),Q=a(29997),J=a(99406);function ee(e){let{t}=(0,g.$G)("workspace"),{client:a}=(0,d.useStatsigClient)();return()=>{J.Am.error(t("files-limit-error","Max number of files allowed is {{maxNumberOfFiles}}",{maxNumberOfFiles:Q.gt})),a.logEvent("workspace_file_limit_exceeded",e,{maxFiles:Q.gt.toString(10)})}}function et(e){var t;let{workspaceId:a,onFileAddStarted:s}=e,{t:i}=(0,g.$G)("workspace"),{client:l}=(0,d.useStatsigClient)(),{data:o}=(0,w.so)(a),c=(0,r.useMemo)(()=>{var e;return null!==(e=null==o?void 0:o.assets)&&void 0!==e?e:[]},[null==o?void 0:o.assets]),u=(0,r.useRef)(null),m=(0,r.useCallback)(()=>{var e;null===(e=u.current)||void 0===e||e.click()},[]),p=ee(a),{mutate:x,error:f}=(0,w.cL)(a);(0,y.c)(f);let{mutate:h,error:b}=(0,w._6)(a);(0,y.c)(b);let{mutate:v,error:j}=(0,w.RL)(a);(0,y.c)(j);let k=(0,r.useCallback)(e=>{if(null==s||s(),c.length+e.length>Q.gt){p(),l.logEvent("ws_max_files_alert",void 0,{location:"file-upload"});return}e.forEach(e=>x(e))},[s,c.length,p,l,x]),C=(0,r.useCallback)(e=>{e.target.files&&(null==s||s(),k(Array.from(e.target.files)))},[s,k]),N=(0,r.useCallback)(()=>(0,n.jsx)("input",{ref:u,className:"hidden",type:"file",onChange:C,multiple:!0,"data-testid":"file-input"}),[C]),{data:S}=(0,w.uq)(),E=null!==(t=null==S?void 0:S.assets)&&void 0!==t?t:[];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(X.t,{label:i("workspace-assets.attach","Attach"),inlineLabel:!0,handleClickUpload:m,onAttachAsset:e=>{if(e&&(null==s||s(),!c.some(t=>t.assetId===e.assetId))){if(c.length+1>Q.gt){p(),l.logEvent("ws_max_files_alert",void 0,{location:"attach-asset"});return}v(e)}},showRecentAssetsForUpload:!0,assets:E,handleUploadThirdParty:(e,t,a,n)=>{if(!c.some(e=>e.thirdPartyFileId===n)){if(c.length+1>Q.gt){p(),l.logEvent("ws_max_files_alert",void 0,{location:"attach-3rd-party"});return}h({name:e,mimeType:t,fileSource:a,thirdPartyFileId:n})}},className:"w-auto me-[1px]",attachFiles:k}),N()]})}function ea(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{threshold:.1},a=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let n=new IntersectionObserver(t=>{t[0].isIntersecting&&e()},t);return a.current&&n.observe(a.current),()=>{a.current&&n.unobserve(a.current)}},[e,t]),a}var en=a(71861),es=a(80296);function er(e){var t,a;let{client:s}=(0,d.useStatsigClient)(),{conversation:i,action:l,onActionRequest:o}=e,c=null!==(t=i.conversationId)&&void 0!==t?t:"",[u,m]=(0,r.useState)(!1),[p,x]=(0,r.useState)(null!==(a=i.title)&&void 0!==a?a:""),[f,h]=(0,r.useState)(!1),[g,b]=(0,r.useState)(""),{routeToConversation:v}=(0,Z.o)();(0,r.useEffect)(()=>{var e;x(null!==(e=i.title)&&void 0!==e?e:"")},[l]);let{mutate:j,error:k}=(0,w.vm)(c);(0,y.c)(k),(0,r.useEffect)(()=>{k&&h(!1)},[k]);let{mutate:C,error:N}=(0,w.DA)(c);(0,y.c)(N),(0,r.useEffect)(()=>{N&&b("")},[N]);let S=(0,r.useCallback)(e=>{v(e)},[s]);if(f)return null;let E=g?{...i,title:g}:i;return(0,n.jsx)("div",{className:"h-[48px] rounded-2xl grid grid-cols-1 grid-rows-1 hover:bg-button-ghost-hover",onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),children:(0,n.jsx)(es.t,{timeRange:"today",isCurrent:!1,isSelected:u,isDeleting:"delete"===l,isEditing:"edit"===l,newTitle:p,onNewTitleChange:x,conversation:E,className:"p-4 rounded-2xl ",onDeleteStart:()=>o(c,"delete"),onEditStart:()=>o(c,"edit"),onDeleteConfirm:()=>{s.logEvent("delete_conversation",c,{location:"workspace"}),o(c,null),h(!0),j()},onCancel:()=>o(c,null),onEditSave:()=>{s.logEvent("update_conversation",c,{location:"workspace"}),o(c,null);let e=p.trim();b(e),C({title:e})},onSelect:S})})}function ei(e){let{conversations:t}=e,{t:a}=(0,g.$G)("workspace"),[s,i]=(0,r.useState)(null),[l,o]=(0,r.useState)(null),c=(0,r.useCallback)((e,t)=>{i(t),o(e)},[]);return 0===t.length?(0,n.jsx)(U,{icon:(0,n.jsx)(en.Z,{size:24,strokeWidth:1.5}),title:a("workspace-conversations-list.empty.label","No conversations yet"),subtitle:a("workspace-conversations-list.empty.cta","Start a new conversation in this workspace by typing in the input box at the top.")}):(0,n.jsx)("div",{children:t.map(e=>{let t=e.conversationId;return(0,n.jsx)(er,{conversation:e,action:l===t?s:null,onActionRequest:c},t)})})}function el(e){var t;let{t:a}=(0,g.$G)("workspace"),{workspace:s}=e,{workspaceId:i}=s,{data:l,isPending:o,isError:c,fetchNextPage:d,hasNextPage:u,isFetchingNextPage:m,refetch:p}=(0,w.Np)(null!=i?i:""),x=ea((0,r.useCallback)(()=>{u&&!m&&d()},[u,m,d]));if(o)return(0,n.jsx)(ec,{});let f=null!==(t=null==l?void 0:l.pages.flatMap(e=>{var t;return null!==(t=e.conversations)&&void 0!==t?t:[]}))&&void 0!==t?t:[];return(0,n.jsxs)(M.u,{fadeSize:"md",className:"py-2",children:[(0,n.jsx)(ei,{conversations:f}),u&&!c&&(0,n.jsx)("div",{ref:x,className:"h-10 flex items-center justify-center",children:m?a("workspace-conversations-loading-more","Loading more…"):a("workspace-conversations-scroll-to-load","Scroll to load more")}),c&&(0,n.jsx)(eo,{onRefetch:p})]})}function eo(e){let{onRefetch:t}=e,{t:a}=(0,g.$G)("workspace");return(0,n.jsxs)(o,{className:"flex flex-col items-center px-8 py-4",variant:"ghost",children:[a("conversations-loading-error.title","Unable to load conversations"),(0,n.jsx)(m.zx,{variant:"outline",onClick:t,children:a("conversations-loading-error.cta","Retry")})]})}function ec(){return(0,n.jsx)(R,{children:(0,n.jsxs)("div",{role:"status","aria-busy":"true",className:"flex flex-col gap-1",children:[(0,n.jsx)(L.O,{className:"w-full h-10"}),(0,n.jsx)(L.O,{className:"w-full h-10"}),(0,n.jsx)(L.O,{className:"w-full h-10"})]})})}var ed=a(12405),eu=a(99189),em=a(90529);let ep=(0,r.forwardRef)((e,t)=>{let{dragState:a,title:s,subtitle:r,className:l}=e,c=(0,i.cn)("absolute inset-0 flex flex-col items-center justify-center gap-1 border justify-center rounded-3xl bg-surface-l1","transition-opacity duration-300 ease-in-out","none"===a?"opacity-0 pointer-events-none":"opacity-100","hover"===a&&"bg-surface-l4-hover dark:bg-surface-l2",l),d="hover"===a;return(0,n.jsxs)(o,{variant:"ghost",className:(0,i.cn)(c),ref:t,children:[(0,n.jsxs)("div",{className:"flex items-center justify-center w-8 h-8",children:[(0,n.jsx)(eu.Z,{size:24,strokeWidth:1.5,className:(0,i.cn)("absolute transition-all duration-300 ease-in-out",d?"opacity-100 scale-100":"opacity-0 scale-75")}),(0,n.jsx)(em.Z,{size:24,strokeWidth:1.5,className:(0,i.cn)("absolute transition-all duration-300 ease-in-out",d?"opacity-0 scale-75":"opacity-100 scale-100")})]}),(0,n.jsx)("span",{className:(0,i.cn)("font-semibold"),children:s}),(0,n.jsx)("span",{className:(0,i.cn)("text-secondary"),children:r})]})});var ex=a(84280),ef=a(49675);function eh(e){let{ref:t,onDrop:a}=e,[n,s]=(0,ex.L)(()=>({accept:[ef.FILE],canDrop:e=>!0,drop(e){let{files:t}=e;a(t)},collect:e=>e.isOver()?"hover":e.getItemType()===ef.FILE?"in-page":"none"}),[a]);return s(t),n}function eg(e){let{onDrop:t,className:a}=e,{t:s}=(0,g.$G)("workspace"),{client:i}=(0,d.useStatsigClient)(),{attachFiles:l}=(0,ed.G)(),o=(0,r.useRef)(null),c=eh({ref:o,onDrop:(0,r.useCallback)(e=>{null==t||t(),l(e),e.forEach(e=>{i.logEvent("upload_file",e.name,{location:"workspace-query-file-drop",mimeType:e.type})})},[l,t,i])});return(0,n.jsx)(ep,{ref:o,dragState:c,title:s("workspace-query-dropzone.title","Attach to query"),subtitle:s("workspace-query-dropzone.description","Drop here to add files to query"),className:a})}var eb=a(51529),ev=a(61090);function ey(e){var t,a;let{open:s,onOpenChange:l,workspace:o}=e,{t:c}=(0,g.$G)("workspace"),d=null!==(t=o.customPersonality)&&void 0!==t?t:"",[u,p]=(0,r.useState)(d);(0,r.useEffect)(()=>{p(d)},[d,s]);let{mutate:x,error:f}=(0,w.Yl)(null!==(a=o.workspaceId)&&void 0!==a?a:"");(0,y.c)(f);let h=(0,r.useId)();return(0,n.jsxs)(j.c,{open:s,setOpen:l,contentClassName:(0,i.cn)("focus:outline-0 focus-within:outline-0 gap-2","bg-background rounded-3xl","w-full md:w-5/6 lg:w-3/5 max-w-3xl","flex flex-col","md:overflow-hidden","px-6 py-6"),children:[(0,n.jsx)(v.fK,{children:(0,n.jsxs)(v.$N,{className:"flex justify-between text-lg",children:[c("workspace-instructions-modal.title","Workspace Instruction"),(0,n.jsx)(m.zx,{className:"-mt-2 -mr-2",variant:"ghost",size:"icon","aria-label":c("workspace-instructions-close.label","Close"),onClick:()=>l(!1),tabIndex:-1,children:(0,n.jsx)(b.b0,{size:18,className:"text-secondary"})})]})}),(0,n.jsx)("div",{className:"text-secondary",children:c("worspace-instruction.description","Grok will respond based on the instruction in all conversations associated with this workspace")}),(0,n.jsx)("label",{className:"sr-only",htmlFor:h,children:c("worspace-instruction.title","Custom instructions")}),(0,n.jsx)(ev.v,{value:u,onChange:p,isDirty:d!==u,onSave:e=>{p(e),x({customPersonality:e}),l(!1)},onReset:()=>{p(d),l(!1)},disabled:!1,textareaId:h})]})}function ew(e){let{workspace:t}=e,{t:a}=(0,g.$G)("workspace"),{client:s}=(0,d.useStatsigClient)(),[i,l]=(0,r.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(m.zx,{variant:"outline",size:"md",rounded:!0,className:"group",onClick:()=>{l(!0),s.logEvent("ws_instructions_click")},children:[(0,n.jsx)(eb.Z,{size:16,className:"text-fg-secondary group-hover:text-fg-primary transition-colors duration-100"}),a("workspace-intruction-button.label","Instructions")]}),(0,n.jsx)(ey,{workspace:t,open:i,onOpenChange:l})]})}var ej=a(64640),ek=a(2799),eC=a(33158),eN=a(89576),eS=a(90517),eE=a(96444);let eI=(0,r.memo)(e=>{let{t}=(0,g.$G)("workspace"),{icon:a,onChange:s}=e,[i,l]=(0,r.useState)(!1),o=(0,eN.w)();(0,r.useEffect)(()=>{l(!1)},[a]);let c=(0,r.useCallback)(e=>{l(!1),s((0,eE.c)(e))},[s]),d=(0,n.jsx)(m.zx,{variant:"ghost",size:"iconMd",overideIconStyle:!0,className:"text-2xl","aria-label":t("workspace-icon.change","Change icon"),children:(0,n.jsx)(u.i,{icon:a,className:"size-6"})});return o?(0,n.jsxs)(ek.dy,{open:i,onOpenChange:l,children:[(0,n.jsx)(ek.Qz,{asChild:!0,children:d}),(0,n.jsxs)(ek.sc,{className:"p-1 max-h-[70dvh]",children:[(0,n.jsxs)(ek.OX,{className:"text-left flex justify-between items-center ",children:[(0,n.jsxs)(ek.iI,{className:"flex gap-2",children:[(0,n.jsx)(P.Z,{size:16,className:"text-secondary"}),t("workspace-icon-drawer.title","Pick new icon")]}),(0,n.jsx)(m.zx,{variant:"ghostSecondary","aria-label":t("close","Close"),onClick:()=>l(!1),children:(0,n.jsx)(eS.Z,{size:16})})]}),(0,n.jsx)(ej.$1,{onSelect:c})]})]}):(0,n.jsxs)(eC.J2,{open:i,onOpenChange:l,children:[(0,n.jsx)(eC.xo,{asChild:!0,children:d}),(0,n.jsx)(eC.yk,{className:"p-0 border",align:"start",children:(0,n.jsx)(ej.$1,{onSelect:c})})]})});var e_=a(67989);let eT=(0,r.memo)(e=>{var t,a;let{workspace:s,editing:i,onEditingChange:l}=e,{t:o}=(0,g.$G)("workspace"),c=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!i||!c.current)return;if("none"!==document.body.style.pointerEvents){var e;null===(e=c.current)||void 0===e||e.select();return}let t=setTimeout(()=>{var e;null===(e=c.current)||void 0===e||e.select()},200);return()=>clearTimeout(t)},[i,c]);let[d,u]=(0,r.useState)(null!==(t=s.name)&&void 0!==t?t:"");(0,r.useEffect)(()=>{s.name&&u(s.name)},[s.name]);let{mutate:p,error:x}=(0,w.Yl)(null!==(a=s.workspaceId)&&void 0!==a?a:"");(0,y.c)(x),(0,r.useEffect)(()=>{if(x){var e;u(null!==(e=s.name)&&void 0!==e?e:"")}},[x,s.name]);let h=()=>{p({name:d}),l(!1)},b=(0,r.useId)();return i?(0,n.jsxs)("form",{className:"flex-1 flex gap-2 justify-between items-center min-w-0",onSubmit:e=>{e.preventDefault(),h()},children:[(0,n.jsx)("div",{"aria-live":"polite",className:"sr-only",children:o("workspace-name-save.announce","Editing workspace name")}),(0,n.jsx)("input",{type:"text",value:d,onChange:e=>{u(e.target.value)},onKeyDown:e=>{if("Escape"===e.key){var t;l(!1),u(null!==(t=s.name)&&void 0!==t?t:"")}},onBlur:()=>{},className:"flex-1 px-1 @sm:px-2 text-2xl focus-visible:outline-none bg-input-background py-1 rounded-xl",id:b,ref:c,autoFocus:!0}),(0,n.jsx)(m.zx,{variant:"ghostSecondary",size:"iconMd",rounded:!0,"aria-label":o("workspace-name-save.label","Save"),type:"submit",disabled:!d,children:(0,n.jsx)(e_.Z,{size:16})})]}):(0,n.jsxs)("h1",{role:"button",tabIndex:0,"aria-expanded":"false",onClick:()=>{l(!0)},className:"ms-1 @sm:ms-2 flex-1 bg-transparent text-2xl focus-visible:outline-none border-b-secondary min-w-0 truncate gropu",children:[d,(0,n.jsx)(f.Z,{size:16,className:"hidden @sm:inline ms-1 @sm:ms-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-fg-secondary"})]})}),eZ=(0,r.memo)(function(e){var t;let{workspace:a}=e,{push:s}=(0,c.p)(),[i,l]=(0,r.useState)(!1),{mutate:o,error:d}=(0,w.Yl)(null!==(t=a.workspaceId)&&void 0!==t?t:"");(0,y.c)(d);let u=(0,r.useCallback)(e=>{o({icon:e})},[o]);return(0,n.jsxs)("div",{className:"flex flex-col @sm:flex-row items-start @sm:items-center gap-6 @sm:gap-2 w-full",children:[(0,n.jsxs)("div",{className:"flex-1 flex items-center justify-start group min-w-0 w-full",children:[(0,n.jsx)(eI,{icon:a.icon,onChange:u}),(0,n.jsx)(eT,{workspace:a,editing:i,onEditingChange:l}),(0,n.jsx)(C,{workspace:a,className:"m-[1px] ms-1 @sm:ms-2",iconSize:16,onDeleteStarted:()=>{s({page:"workspaces"})},onEditStarted:()=>{l(!0)}})]}),(0,n.jsx)(ew,{workspace:a})]})});function eD(e){var t;let{onDrop:a,className:s,workspaceId:i}=e,{t:l}=(0,g.$G)("workspace"),{client:o}=(0,d.useStatsigClient)(),{mutate:c,error:u}=(0,w.cL)(i);(0,y.c)(u);let m=ee(i),{data:p}=(0,w.so)(i),x=null!==(t=null==p?void 0:p.assets)&&void 0!==t?t:[],f=(0,r.useRef)(null),h=eh({ref:f,onDrop:(0,r.useCallback)(e=>{if(null==a||a(),x.length+e.length>Q.gt){m(),o.logEvent("ws_max_files_alert",void 0,{location:"workspace-file-drop"});return}e.forEach(e=>(o.logEvent("upload_file",e.name,{location:"workspace-file-drop",mimeType:e.type}),c(e)))},[x.length,a,m,o,c])});return(0,n.jsx)(ep,{ref:f,dragState:h,title:l("workspace-dropzone.title","Attach to workspace"),subtitle:l("workspace-dropzone.description","Drop here to add files to workspace"),className:s})}function eA(e){var t;let{workspace:a}=e,{t:s}=(0,g.$G)("chat"),{client:i}=(0,d.useStatsigClient)(),l=null!==(t=a.workspaceId)&&void 0!==t?t:"",o=(0,Z.o)(),u=function(){let{client:e}=(0,d.useStatsigClient)();return t=>e.logEvent("create_workspace_convo",t)}(),{route:m,replace:p}=(0,c.p)(),x="workspace"===m.page&&m.tab||"conversations",{mutate:f,error:h}=(0,w.J2)({onSuccess:u});(0,y.c)(h);let b=function(e,t){let{client:a}=(0,d.useStatsigClient)(),n=(0,_.useSession)().user,s=(0,z.gK)(K.Z("establishNewConversation")),i=(0,O.F)(K.Z("isIncognito")),l=(0,z.gK)(K.Z("activeModelId")),o=(0,z.gK)(K.Z("outputMode")),c=(0,z.gK)(K.Z("reasoningMode")),u=(0,D.g)();return(0,r.useCallback)(async(a,n,r,l,o,c)=>{let d;if(!a)return!1;u.WORKSPACE_AGENT&&(d={agenticWorkspace:{workspaceId:e}});let m=await s({message:a,fileAttachmentIds:n,webpageUrls:r,toolOverrides:l,temporary:i,isPreset:o,persona:c,enableRetries:u.ENABLE_AUTO_STREAM_RETRY,workspaceIds:[e],responseMetadata:d}).catch(e=>{(0,A.H)("workspace:establishNewConversation",e)});return!!m&&(t(m),!0)},[l,n,u,a,i,o,c])}(l,e=>{f({conversationId:e.conversationId,workspaceId:l}),o.routeToConversation(e.conversationId),i.logEvent("ws_start_convo")});if(!l)return;let v=()=>{p({page:"workspace",workspaceId:l,tab:"attachments"})};return(0,n.jsxs)("div",{className:"flex-1 flex gap-6 h-full flex-col justify-between items-stretch overflow-hidden",children:[(0,n.jsx)(eZ,{workspace:a}),(0,n.jsxs)("div",{className:"flex-1 overflow-auto flex gap-6 flex-col @sm:flex-col-reverse",children:[(0,n.jsxs)(T.mQ,{value:x,className:"flex-1 overflow-hidden flex flex-col relative pt-1",children:[(0,n.jsxs)("div",{className:"flex justify-between sm:ms-1",children:[(0,n.jsxs)(T.dr,{className:"place-self-start !bg-transparent bg-none",children:[(0,n.jsx)(T.SP,{variant:"underline",value:"attachments",asChild:!0,children:(0,n.jsx)(c.r,{route:{page:"workspace",workspaceId:l,tab:"attachments"},children:s("workspace-tab.attachments","Attachments")})}),(0,n.jsx)(T.SP,{variant:"underline",value:"conversations",children:(0,n.jsx)(c.r,{route:{page:"workspace",workspaceId:l,tab:"conversations"},children:s("workspace-tab.conversations","Conversations")})})]}),(0,n.jsx)(et,{workspaceId:l,onFileAddStarted:v})]}),(0,n.jsx)(T.nU,{value:"conversations",className:"overflow-auto pb-5",children:(0,n.jsx)(el,{workspace:a})}),(0,n.jsx)(T.nU,{value:"attachments",className:"overflow-hidden flex-1 pb-5",children:(0,n.jsx)(q,{workspace:a})}),(0,n.jsx)(eD,{workspaceId:l,onDrop:v})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(I.B,{className:"",textAreaClassName:"min-h-14 pt-5 my-0 mb-5",placeholder:s("workspac-query-placeholder","Start a conversation in this workspace"),onQuery:b,isIncognito:!1,onFrontPage:!1,expandable:!1},"query-bar"),(0,n.jsx)(eg,{className:"z-20"})]})]})]})}function eO(e){let{workspaceId:t}=e,{t:a}=(0,g.$G)("chat"),{isPending:s,data:i,isError:l}=(0,w.cF)(t);return((0,r.useEffect)(()=>{(null==i?void 0:i.name)&&(document.title=i.name+" - Grok")},[i]),s)?null:l?(0,n.jsx)(E._,{title:a("workspace-error.title","Error"),description:a("workspace-error.description","There was an issue finding ID {{workspaceId}}",{workspaceId:t}),cta:a("workspace-error.cta","Go Home")}):(0,n.jsxs)(S.S,{fallbackRender:()=>(0,n.jsx)(E._,{title:a("workspace-error.title","Error"),description:a("workspace-unexpected-error.description","Something went wrong"),cta:a("workspace-error.cta","Go Home")}),children:[(0,n.jsx)(eA,{workspace:i}),";"]})}var eK=a(78161),ez=a(60092),eR=a(3944);function eM(e){let{variant:t,onClick:a,className:s}=e,{t:r}=(0,g.$G)("workspace"),{add:l,isPending:o}=(0,eR.V)(),c="square"===t,d=(0,i.cn)(s);return(0,n.jsxs)(m.zx,{variant:"outline",size:c?"iconMd":"md",className:d,onClick:()=>{null==a||a(),l()},"aria-busy":o,"aria-label":o?r("add-workspace-button.pending","Creating workspace"):r("add-workspace-button.description","Add new workspace"),children:[o?(0,n.jsx)(eK.Z,{className:"animate-spin",size:16,"aria-hidden":!0}):(0,n.jsx)(ez.Z,{size:16,"aria-hidden":!0}),(0,n.jsx)("span",{className:"hidden sm:block",children:c||r("add-workspace-button.label","Add")})]})}var eL=a(22838);function eG(e){var t;let{className:a}=e,{client:s}=(0,d.useStatsigClient)(),{t:l}=(0,g.$G)("workspace"),{data:c,fetchNextPage:u,hasNextPage:m,isFetchingNextPage:p,isPending:x,isError:f,refetch:h}=(0,w._O)(),b=ea((0,r.useCallback)(()=>{m&&!p&&u()},[m,p,u]));if(x)return(0,n.jsx)(eP,{});if(f)return(0,n.jsx)(eF,{onRetry:h});let v=null!==(t=null==c?void 0:c.pages.flatMap(e=>{var t;return null!==(t=e.workspaces)&&void 0!==t?t:[]}))&&void 0!==t?t:[],y=(0,i.cn)("pb-8",a);if(0===v.length)return(0,n.jsxs)(o,{variant:"ghost",className:"p-6 flex flex-col items-center",children:[(0,n.jsx)(P.Z,{size:16,className:"text-secondary"}),(0,n.jsx)("div",{children:l("workspace-list-empty.title","No workspaces yet")}),(0,n.jsx)("div",{className:"text-secondary",children:l("workspace-list-empty.subtitle","Create a new workspace")})]});let j=()=>{s.logEvent("ws_nav_click",void 0,{location:"workspaces"})};return(0,n.jsxs)("div",{"data-testid":"workspaces-list",className:y,children:[(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:v.map(e=>(0,n.jsx)(N,{workspace:e,onClick:j},e.workspaceId))}),m&&(0,n.jsx)("div",{ref:b,className:"text-center mt-8",children:p?l("workspaces-loading.label","Loading more…"):l("workspaces-scrollto.label","Scroll to load more")})]})}function eF(e){let{onRetry:t}=e,{t:a}=(0,g.$G)("workspace");return(0,n.jsxs)(o,{variant:"ghost",className:"p-8 flex flex-col gap-4 items-center text-center",children:[(0,n.jsx)(eL.Z,{className:"size-4"}),a("workspaces-error.description","An issue occurred when loading your workspaces"),(0,n.jsx)(m.zx,{variant:"outline",className:"shadow-none",onClick:t,children:a("workspaces-error.cta","Try again")})]})}function eP(){return(0,n.jsx)(R,{children:(0,n.jsxs)("div",{className:"flex flex-col @sm:flex-row gap-3",children:[(0,n.jsx)(eH,{}),(0,n.jsx)(eH,{}),(0,n.jsx)(eH,{})]})})}function eH(){return(0,n.jsxs)(o,{variant:"ghost",className:"flex-1 rounded-xl p-4 flex @sm:flex-col items-center  @sm:items-start gap-4",children:[(0,n.jsx)(L.O,{className:"bg-surface-l1 w-8 h-8 rounded-full"}),(0,n.jsx)(L.O,{className:"bg-surface-l1 w-32 h-4"})]})}function eU(){let{client:e}=(0,d.useStatsigClient)(),{t}=(0,g.$G)("workspace");return(0,n.jsxs)("main",{className:"w-full h-full flex flex-col",children:[(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"flex justify-between align-center my-6 min-h-[42px]",children:[(0,n.jsxs)("h1",{className:"text-2xl flex gap-2 items-center",children:[(0,n.jsx)(P.Z,{size:24,className:"min-w-8"}),t("workspaces-page.title","Workspaces")]}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)(eM,{onClick:()=>{e.logEvent("ws_create_click",void 0,{location:"workspaces"})}})})]})}),(0,n.jsx)(M.u,{children:(0,n.jsx)(eG,{})})]})}},3944:function(e,t,a){a.d(t,{V:function(){return u}});var n=a(64640),s=a(54670),r=a(97981);function i(e){return e[Math.floor(Math.random()*e.length)]}var l=a(32088),o=a(77717),c=a(66070),d=a(96444);function u(){let{t:e}=(0,c.$G)("workspace"),{client:t}=(0,l.useStatsigClient)(),a=(0,o.useRouter)(),{mutate:u,isPending:m}=(0,s.Wq)({onError:r.xo,onSuccess:e=>(t.logEvent("ws_create",e.workspaceId),a.push("/workspace/".concat(e.workspaceId)))});return{isPending:m,add:()=>{u({name:e("workspace-default-name","New Workspace"),icon:function(){let e=i(Object.keys(n.ci)),t=i(n.O9);return(0,d.c)({icon:e,color:t})}()})}}}},96444:function(e,t,a){a.d(t,{c:function(){return s},g:function(){return r}});var n=a(64640);function s(e){return"l:".concat(e.icon,":").concat(e.color)}function r(e){let t=RegExp("^l:(?<icon>[^:]+):(?<color>[^:]+)$"),a=e.match(t);if(null==a?void 0:a.groups){let{color:e,icon:t}=a.groups;if(n.O9.includes(e)&&n.ci[t])return{color:e,icon:t}}return null}},55342:function(e,t,a){a.d(t,{i:function(){return l}});var n=a(584),s=a(64640),r=a(5780),i=a(96444);function l(e){let{icon:t,className:a,size:l}=e;if(!t)return(0,n.jsx)(r.Z,{className:a,size:l});let o=(0,i.g)(t);return o?(0,n.jsx)(s.mO,{value:o,className:a,size:l}):(0,n.jsx)(r.Z,{className:a})}},98964:function(e,t,a){a.d(t,{$Y:function(){return r},DA:function(){return n},zS:function(){return s}});let n="/connect-oauth-error",s="/api/exchange-token/",r="oauth_provider"},15674:function(e,t,a){a.d(t,{U:function(){return o}});var n=a(32791),s=a(879),r=a(57750),i=a(9354),l=a(50240);let o=()=>{let e=(0,r.F)(i.Z("selectedLanguage"));return(0,l.useMemo)(()=>e||n.Z.languages.find(e=>e in s.l2)||s.sm,[n.Z.languages,e])}},12405:function(e,t,a){a.d(t,{G:function(){return d},i:function(){return u}});var n=a(19922),s=a(29997),r=a(46751),i=a(9354),l=a(50240),o=a(66070),c=a(99406);function d(){let{t:e}=(0,o.$G)("base"),t=(0,n.gK)(i.Z("conversationId")),a=(0,r.O)(i.Z("listByConversationId")),d=(0,r.O)(i.Z("delistByConversationId")),u=(0,r.O)(i.Z("attachListByConversationId")),m=(0,r.O)(i.Z("fetchUploadFile")),p=t||"no_conversation_id",x=a[p]||[];return{attachFiles:(0,l.useCallback)(t=>{var a;if(!t.length)return!1;let n=null!==(a=u[p])&&void 0!==a?a:[],r=t.filter(e=>(e.type,!0));if(x.length+n.length+r.length>s.gt){c.Am.error(e("Can only submit a maximum of max files per message. Please remove some files before uploading more.","Can only submit a maximum of {{max}} files per message. Please remove some files before uploading more.",{max:s.gt}));return}r.forEach(e=>{m(e,p).metadataPromise.catch(e=>{c.Am.error(e.message)})})},[x,p,u]),detachFile:(0,l.useCallback)((e,t)=>{if(!e.current){t&&d(p,t);return}let a=e.current.files;if(!a||!t)return;let n=new DataTransfer;Array.from(a).forEach(e=>{e!=e&&n.items.add(e)}),e.current.files=n.files,d(p,t)},[p])}}function u(e){return({".png":"image/png",".jpg":"image/jpeg",".jpeg":"image/jpeg",".webp":"image/webp",".txt":"text/plain",".log":"text/plain",".md":"text/plain",".csv":"application/csv",".json":"application/json",".yaml":"application/x-yaml",".yml":"application/x-yaml",".xml":"application/xml",".toml":"application/toml",".pdf":"application/pdf",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})[e.startsWith(".")?e.toLowerCase():"."+e.toLowerCase()]||"text/plain"}},86867:function(e,t,a){a.d(t,{m:function(){return r}});var n=a(7263),s=a(50240);function r(){let e=(0,s.useRef)(null),[t,a]=(0,s.useState)(!1),[r,i]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let t=()=>{e.current&&(e.current.scrollLeft>0?a(!0):a(!1),e.current.scrollLeft+e.current.clientWidth>=e.current.scrollWidth?i(!0):i(!1))},n=e.current;return n&&n.addEventListener("scroll",t),()=>{n&&n.removeEventListener("scroll",t)}},[]),{scrollRef:e,className:(0,n.cn)("will-change-[mask-image] @sm:[mask-image:none]",{"[mask-image:linear-gradient(to_right,transparent_0,black_0px,black_calc(100%_-_40px),transparent_100%)]":!t,"[mask-image:linear-gradient(to_right,transparent_0,black_20px,black_calc(100%_-_40px),transparent_100%)]":t&&!r,"[mask-image:linear-gradient(to_right,transparent_0,black_20px,black_100%)]":t&&r})}}},3210:function(e,t,a){a.d(t,{D:function(){return r}});var n=a(50240);function s(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function r(){let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{t(s)},[]),e}},49901:function(e,t,a){a.d(t,{h:function(){return i}});var n=a(79972),s=a(93440),r=a(25693);function i(){let{user:e}=(0,n.kP)();return(0,r.aM)({queryKey:["oauth-connectors"],queryFn:async()=>{var e;let t=await (0,s.kG)("/api/oauth-connectors",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error((await t.json()).error);return null!==(e=(await t.json()).oauthConnectors)&&void 0!==e?e:[]},enabled:!!e,staleTime:6e4})}},29997:function(e,t,a){a.d(t,{Ag:function(){return r},dI:function(){return s},gt:function(){return i}});var n=a(83759);let s=39e4,r=10,i=10;n.Hu,n.Vb,n.JY},65505:function(e,t,a){a.d(t,{p:function(){return p},r:function(){return m}});var n=a(584),s=a(77717),r=a(25888),i=a(50240),l=a(19360);let o=["conversations","attachments"],c=new r.y("/workspace"),d=new r.y("/workspace/:id");function u(e){switch(e.page){case"main":case"unknown":return{pathname:"/"};case"workspaces":return{pathname:"/workspace"};case"workspace":return{pathname:"/workspace/"+e.workspaceId,query:{tab:"attachments"!==e.tab?e.tab:void 0}};default:return console.error("Unhandled route case:",e),{}}}let m=(0,i.forwardRef)((e,t)=>{let{route:a,onClick:s,...r}=e,l=(0,i.useMemo)(()=>x(u(a)),[a]),o=(0,i.useCallback)(e=>{var t;null==s||s(e),e.defaultPrevented||function(e){let t=e.currentTarget.getAttribute("target");return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||2===e.button}(e)||(e.preventDefault(),null===(t=globalThis)||void 0===t||t.window.history.pushState({},"",l))},[s,l]);return(0,n.jsx)("a",{...r,onClick:o,href:l,ref:t})});function p(){let{push:e,replace:t}=(0,s.useRouter)(),a=(0,s.usePathname)(),n=(0,s.useSearchParams)(),r=(0,i.useCallback)(t=>{e(x(u(t)))},[e]),l=(0,i.useCallback)(e=>{t(x(u(e)))},[t]);return(0,i.useMemo)(()=>({push:r,replace:l,route:function(e,t){if("/"===e)return{page:"main"};if(c.test(e))return{page:"workspaces"};let a=d.test(e);if(null==a?void 0:a.id){var n,s;let e=null!==(n=t.get("tab"))&&void 0!==n?n:"";return{page:"workspace",workspaceId:a.id,tab:null!==(s=o.includes(e)?e:void 0)&&void 0!==s?s:"attachments"}}return{page:"unknown"}}(a,n)}),[r,l,a,n.toString()])}function x(e){if(e.query&&"string"!=typeof e.query)for(let t in e.query)void 0===e.query[t]&&delete e.query[t];return(0,l.format)(e)}},16199:function(e,t,a){a.d(t,{Z:function(){return n}});function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}},23310:function(e,t,a){a.d(t,{_:function(){return r}});var n=a(27435);class s{constructor(e,t){this.set=e,this.get=t,this.isUpselling=!1,this.setIsUpselling=(0,n.f0)(this.set,"isUpselling")}}let r=(0,n.MT)(s);"#subscribe"===window.location.hash&&r.getState().setIsUpselling(!0),r.subscribe((e,t)=>{var a;e.isUpselling!==t.isUpselling&&(a=e.isUpselling?"subscribe":void 0,window.history.pushState({},"","".concat(window.location.pathname).concat(a?"#".concat(a):"")))}),window.addEventListener("popstate",()=>{let e=window.location.hash;r.getState().setIsUpselling("#subscribe"===e)})}}]);